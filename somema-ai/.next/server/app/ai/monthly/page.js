(()=>{var e={};e.id=4995,e.ids=[4995],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5336:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(62688).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},9005:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(62688).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},10780:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/ai/monthly/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/ai/monthly/page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12294:(e,t,s)=>{"use strict";s.d(t,{$:()=>n});var a=s(60687),r=s(43210),l=s.n(r),i=s(96241);let n=l().forwardRef(({className:e,variant:t="primary",size:s="md",loading:r=!1,children:l,disabled:n,...o},d)=>(0,a.jsxs)("button",{className:(0,i.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-50",ghost:"text-gray-900 hover:bg-gray-100",destructive:"bg-red-600 text-white hover:bg-red-700 border border-red-600"}[t],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[s],e),ref:d,disabled:n||r,...o,children:[r&&(0,a.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),l]}));n.displayName="Button"},16396:(e,t,s)=>{"use strict";s.d(t,{$G:()=>r,ND:()=>a});let a=(0,s(59522).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),r=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33395:(e,t,s)=>{Promise.resolve().then(s.bind(s,10780))},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},40228:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(62688).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},46055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(31658);let r=async e=>[{type:"image/x-icon",sizes:"500x500",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},47990:()=>{},48444:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var a=s(60687),r=s(43210),l=s.n(r),i=s(96241);let n=l().forwardRef(({className:e,type:t,label:s,error:l,helperText:n,id:o,...d},c)=>{let m=(0,r.useId)(),h=o||`input-${m}`;return(0,a.jsxs)("div",{className:"w-full",children:[s&&(0,a.jsx)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 mb-1",children:s}),(0,a.jsx)("input",{type:t,className:(0,i.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",l&&"border-red-500 focus-visible:ring-red-500",e),ref:c,id:h,...d}),l&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:l}),n&&!l&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:n})]})});n.displayName="Input"},50940:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(62688).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},51319:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>d});var a=s(65239),r=s(48088),l=s(88170),i=s.n(l),n=s(30893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d={children:["",{children:["ai",{children:["monthly",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,10780)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/ai/monthly/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/ai/monthly/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/ai/monthly/page",pathname:"/ai/monthly",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56085:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(62688).A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},62688:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(43210);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),i=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),o=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:l="",children:i,iconNode:c,...m},h)=>(0,a.createElement)("svg",{ref:h,...d,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:n("lucide",l),...!i&&!o(m)&&{"aria-hidden":"true"},...m},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(i)?i:[i]])),m=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...l},o)=>(0,a.createElement)(c,{ref:o,iconNode:t,className:n(`lucide-${r(i(e))}`,`lucide-${e}`,s),...l}));return s.displayName=i(e),s}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69842:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(60687),r=s(43210),l=s(16189),i=s(85814),n=s.n(i),o=s(16396),d=s(12294),c=s(48444),m=s(50940),h=s(40228),u=s(9005),g=s(56085),x=s(5336);let p=({src:e,fileName:t,className:s})=>{let l=(0,r.useRef)(null),[i,n]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1),[c,m]=(0,r.useState)(!0),[h,u]=(0,r.useState)(!1),g=()=>{l.current&&(l.current.muted=!l.current.muted,m(l.current.muted))};return o?(0,a.jsx)("div",{className:`${s} bg-gray-200 flex items-center justify-center group relative overflow-hidden`,children:(0,a.jsxs)("div",{className:"text-gray-500 text-center",children:[(0,a.jsx)("div",{className:"text-lg mb-1",children:"\uD83C\uDFA5"}),(0,a.jsx)("div",{className:"text-xs",children:"Video Error"}),(0,a.jsx)("div",{className:"text-xs opacity-75 mt-1 truncate max-w-full px-2",children:t})]})}):(0,a.jsxs)("div",{className:`${s} bg-gray-200 flex items-center justify-center group relative overflow-hidden cursor-pointer`,onClick:()=>{l.current&&(i?l.current.pause():l.current.play().catch(console.error))},onMouseEnter:()=>u(!0),onMouseLeave:()=>{u(!1),l.current&&i&&l.current.pause()},children:[(0,a.jsx)("video",{ref:l,src:e,className:"w-full h-full object-cover",muted:c,playsInline:!0,loop:!0,onPlay:()=>{n(!0)},onPause:()=>{n(!1)},onError:()=>{d(!0)},onMouseEnter:e=>{e.currentTarget.play().catch(console.error)}}),!i&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-white bg-opacity-95 backdrop-blur-sm rounded-full p-2 shadow-2xl hover:bg-opacity-100 hover:scale-110 transition-all duration-200 cursor-pointer",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-800 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M8 5v14l11-7z"})})})}),i&&h&&(0,a.jsx)("div",{className:"absolute top-2 right-2",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:(0,a.jsx)("div",{onClick:e=>{e.stopPropagation(),g()},className:"bg-black bg-opacity-70 hover:bg-opacity-90 rounded-full p-1.5 shadow-lg hover:scale-110 transition-all duration-200 backdrop-blur-sm cursor-pointer",title:c?"Unmute":"Mute",children:c?(0,a.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})}):(0,a.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate",children:t})]})};function b(){let[e,t]=(0,r.useState)([]),[s,i]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)("instagram"),[j,w]=(0,r.useState)(""),[N,k]=(0,r.useState)(""),[I,_]=(0,r.useState)([]),[S,C]=(0,r.useState)(!1),[A,P]=(0,r.useState)(""),[M,E]=(0,r.useState)({}),[D,F]=(0,r.useState)(null),[z,O]=(0,r.useState)(null),[$,U]=(0,r.useState)(null),[L,T]=(0,r.useState)(""),[q,R]=(0,r.useState)(""),[W,J]=(0,r.useState)(null),[G,B]=(0,r.useState)({}),[X,Z]=(0,r.useState)({}),[H,V]=(0,r.useState)({}),[Y,K]=(0,r.useState)({}),[Q,ee]=(0,r.useState)(!1),[et,es]=(0,r.useState)([]),[ea,er]=(0,r.useState)("11:00"),[el,ei]=(0,r.useState)(null),en=(0,l.useRouter)(),eo=function(){let e=[],t=new Date,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let r=1;r<=30;r++){let l=new Date(t);l.setDate(t.getDate()+r);let i=a[l.getDay()],n=`${l.getDate()} ${s[l.getMonth()]} ${l.getFullYear()}`;e.push({day:i,date:n,dateObj:l})}return e}(),ed=async()=>{if(0===Object.values(M).flat().length)return void w("Please select at least one image to generate content");if(!z)return void w("Please complete your profile setup first");if(!z.business_name||""===z.business_name)return void w("Please complete your business profile setup first. Go to Settings to add your business details.");f(!0),w(""),k("");let{data:{user:s}}=await o.ND.auth.getUser();try{console.log("Sending userProfile to API:",z);let a=await fetch("/api/generate-monthly-content",{method:"POST",headers:{"Content-Type":"application/json",...s?.id?{Authorization:`Bearer ${s.id}`}:{}},body:JSON.stringify({imageSelections:M,userProfile:z,platform:y})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to generate content")}let r=await a.json();console.log("Generated monthly content:",r.generatedPosts);let l=e.map((e,t)=>{let s=eo[t]?.day+" "+eo[t]?.date,a=M[s];if(!a||0===a.length)return{...e,status:"pending",selectedImage:null};let l=r.generatedPosts.find(e=>e.dayKey===s);return l?{...e,theme:l.theme,caption:l.caption,hashtags:l.hashtags,imagePrompt:l.imagePrompt,status:"generated",selectedImage:l.selectedImages[0],selectedImages:l.selectedImages,scheduledFor:eh(e.day.toString(),ea)}:{...e,status:"pending",selectedImage:a[0]}});t(l),k("Monthly content generated successfully!"),E({}),ee(!0)}catch(e){console.error("Error generating monthly content:",e),w(e.message||"Failed to generate content. Please try again.")}finally{f(!1)}},ec=async()=>{i(!0),w("");try{let{data:{user:t}}=await o.ND.auth.getUser();if(!t)throw Error("User not authenticated");let s=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{let s=e.selectedImages&&e.selectedImages.length>1,a=s?e.selectedImages.map((t,s)=>X[e.id]?.[s]||t.file_path):[],r=s?X[e.id]?.[0]||e.selectedImages[0].file_path:X[e.id]?.[0]||e.selectedImage?.file_path;return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"draft",scheduled_for:e.scheduledFor||eh(e.day.toString()),media_url:r,media_urls:a,enhanced_image_url:X[e.id]?.[0]||null,theme:e.theme,content_type:"monthly",business_context:`Day: ${e.day}, Image Prompt: ${e.imagePrompt}`}});if(0===s.length)return void w("No posts to save. Please generate content first.");let{error:a}=await o.ND.from("posts").insert(s);if(a)throw a;k("Monthly content saved successfully!"),en.push("/dashboard")}catch(e){w(e.message)}finally{i(!1)}},em=async()=>{i(!0),w("");try{let{data:{user:t}}=await o.ND.auth.getUser();if(!t)throw Error("User not authenticated");let s=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{let s=e.selectedImages&&e.selectedImages.length>1,a=s?e.selectedImages.map((t,s)=>X[e.id]?.[s]||t.file_path):[],r=s?X[e.id]?.[0]||e.selectedImages[0].file_path:X[e.id]?.[0]||e.selectedImage?.file_path;return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"scheduled",scheduled_for:e.scheduledFor||eh(e.day.toString()),media_url:r,media_urls:a,enhanced_image_url:X[e.id]?.[0]||null,theme:e.theme,content_type:"monthly",business_context:`Day: ${e.day}, Image Prompt: ${e.imagePrompt}`}});if(0===s.length)return void w("No posts to schedule. Please generate content first.");let{error:a}=await o.ND.from("posts").insert(s);if(a)throw a;k("Monthly content scheduled successfully!"),setTimeout(()=>{en.push("/calendar")},2e3)}catch(e){w(e.message)}finally{i(!1)}},eh=(e,t=ea)=>{let s=parseInt(e)-1,a=eo[s]?.dateObj;if(!a)return console.error("Invalid day number:",e),new Date().toISOString();let r=new Date(a),[l,i]=t.split(":").map(Number);return r.setHours(l,i,0,0),r.toISOString()},eu=e=>{let t=new Date(e);return t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})+" at "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},eg=e=>{t(t=>t.map(t=>({...t,scheduledFor:t.scheduledFor?eh(t.day.toString(),e):void 0})))},ex=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,scheduledFor:eh(t.day.toString(),s)}:t))},ep=(e,t,s,a)=>{U(e),T(t),R(s.join(" ")),J(a?new Date(a).toISOString().slice(0,16):null)},eb=async(e,t,s,a)=>{B(t=>({...t,[e]:{...t[e]||{},[a]:!0}})),w(""),K(t=>{let s={...t};return s[e]&&(delete s[e][a],0===Object.keys(s[e]).length&&delete s[e]),s});try{let r;if(t.startsWith("blob:")){let e=await fetch(t),s=await e.blob();r=new File([s],"image.jpg",{type:s.type})}else if(t.startsWith("data:")){let e=await fetch(t),s=await e.blob();r=new File([s],"image.jpg",{type:s.type})}else{let e=await fetch(t),s=await e.blob();r=new File([s],"image.jpg",{type:s.type})}let{data:{session:l}}=await o.ND.auth.getSession();if(!l?.access_token)throw Error("User not authenticated");let i=new FormData;i.append("image",r),i.append("productDescription",s);let n=await fetch("/api/enhance-image",{method:"POST",headers:{Authorization:`Bearer ${l.access_token}`},body:i});if(!n.ok){let e=await n.json();if("safety_violation"===e.errorType)throw Error("This image cannot be enhanced due to content policy restrictions. Please try with a different image.");throw Error(e.error||"Failed to enhance image")}let d=await n.json();Z(t=>({...t,[e]:{...t[e]||{},[a]:d.enhancedImageUrl}})),V(t=>({...t,[e]:{...t[e]||{},[a]:!0}})),console.log("Image enhanced successfully:",d.enhancedImageUrl),void 0!==d.creditsRemaining&&(k(`Image enhanced successfully! ${d.creditsRemaining} enhancement credits remaining.`),setTimeout(()=>k(""),3e3))}catch(t){console.error("Error enhancing image:",t),K(s=>({...s,[e]:{...s[e]||{},[a]:t.message||"Failed to enhance image"}}))}finally{B(t=>({...t,[e]:{...t[e]||{},[a]:!1}}))}},ef=(e,t)=>{V(s=>({...s,[e]:{...s[e]||{},[t]:!1}})),Z(s=>{let a={...s};return a[e]&&(delete a[e][t],0===Object.keys(a[e]).length&&delete a[e]),a}),K(s=>{let a={...s};return a[e]&&(delete a[e][t],0===Object.keys(a[e]).length&&delete a[e]),a})};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(n(),{href:"/dashboard",children:(0,a.jsxs)(d.$,{variant:"ghost",size:"sm",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(h.A,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Monthly Content Generator"})]})]})})}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-4 lg:px-8 py-6 sm:py-8",children:[j&&(0,a.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-red-800 text-xs sm:text-sm",children:j})}),N&&(0,a.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-green-800 text-xs sm:text-sm",children:N})}),!Q&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6 mb-6 sm:mb-8",children:[(0,a.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Add Images for Each Day (Optional, up to 10 per day)"}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-10 gap-2 sm:gap-4",children:eo.map(({day:e,date:t})=>{let s=e+" "+t;return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700 mb-1 text-xs",children:e}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mb-2",children:t}),M[s]&&M[s].length>0?(0,a.jsxs)("div",{className:"relative group image-selected flex flex-wrap gap-1 justify-center",children:[M[s].map((t,r)=>(0,a.jsxs)("div",{className:"relative",children:[t.mime_type&&t.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:t.file_path,className:"w-12 h-12 object-cover rounded shadow mb-1",muted:!0,playsInline:!0}):(0,a.jsx)("img",{src:t.file_path,alt:e,className:"w-12 h-12 object-cover rounded shadow mb-1"}),(0,a.jsx)("button",{className:"absolute top-0 right-0 bg-white bg-opacity-80 rounded-full p-0.5 text-red-500 hover:text-red-700 text-xs",onClick:()=>E(e=>({...e,[s]:e[s].filter((e,t)=>t!==r)})),"aria-label":"Remove image",children:"\xd7"})]},t.id)),M[s].length<10&&(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>F(s),className:"w-12 h-12 flex items-center justify-center",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Add Image"})]}),M[s].length>1&&(0,a.jsx)("span",{className:"absolute bottom-0 left-0 bg-blue-600 text-white text-xs px-1 rounded",children:"Carousel"})]}):(0,a.jsxs)(d.$,{variant:"outline",size:"sm",onClick:()=>F(s),children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-1"}),"Select Image"]})]},s)})}),(0,a.jsx)("div",{className:"mt-6 sm:mt-8 flex gap-2 sm:gap-3 justify-center",children:(0,a.jsxs)(d.$,{onClick:ed,disabled:0===Object.values(M).flat().length,loading:b,variant:"primary",className:"btn-generate",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),b?"Generating Content...":"Generate Monthly Content"]})}),(0,a.jsx)("div",{className:"mt-3 text-sm text-gray-600 text-center",children:0===Object.values(M).flat().length?(0,a.jsx)("span",{className:"text-orange-600",children:"⚠️ Please select at least one image to enable generation"}):(0,a.jsxs)("span",{className:"text-green-600",children:["✅ ",Object.values(M).flat().length," image(s) selected"]})})]}),D&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-4xl w-full p-6 relative animate-fade-in",children:[(0,a.jsx)("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",onClick:()=>{F(null),es([])},"aria-label":"Close",children:"\xd7"}),(0,a.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Select Images for ",D.slice(0,D.indexOf(","))," ",D.slice(D.indexOf(",")+1)," (Up to 10)"]}),et.length>0&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Selected Images (",et.length,"/10)"]}),(0,a.jsx)("button",{onClick:()=>es([]),className:"text-xs text-red-600 hover:text-red-800",children:"Clear All"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:et.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:e.file_path,className:"w-12 h-12 object-cover rounded",muted:!0,playsInline:!0}):(0,a.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-12 h-12 object-cover rounded"}),(0,a.jsx)("button",{onClick:()=>es(e=>e.filter((e,s)=>s!==t)),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"\xd7"})]},e.id))})]}),S?(0,a.jsx)("div",{className:"text-gray-500",children:"Loading media..."}):A?(0,a.jsx)("div",{className:"text-red-500",children:A}):(0,a.jsxs)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3 max-h-96 overflow-y-auto",children:[Array.isArray(I)&&I.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).map(e=>{let t=et.some(t=>t.id===e.id);return(0,a.jsxs)("button",{className:`focus:outline-none border-2 rounded overflow-hidden transition-all relative ${t?"border-blue-500 bg-blue-50":"border-transparent hover:border-blue-300"}`,onClick:()=>{t?es(t=>t.filter(t=>t.id!==e.id)):et.length<10&&es(t=>[...t,e])},children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,a.jsx)(p,{src:e.file_path,fileName:e.file_name,className:"w-full h-20"}):(0,a.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-full h-20 object-cover"}),t&&(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"✓"})]},e.id)}),(!Array.isArray(I)||Array.isArray(I)&&0===I.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).length)&&(0,a.jsx)("div",{className:"col-span-full text-gray-500",children:"No media found in your media library."})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>{F(null),es([])},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsxs)("button",{onClick:()=>{E(e=>({...e,[D]:et})),F(null),es([])},disabled:0===et.length,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Add ",et.length," Image",1!==et.length?"s":""]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Monthly Content Preview"}),e.some(e=>"generated"===e.status)&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Default Time:"}),(0,a.jsx)("input",{type:"time",value:ea,onChange:e=>{er(e.target.value),eg(e.target.value)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(d.$,{onClick:ec,loading:s,variant:"outline",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Save as Draft"]}),(0,a.jsxs)(d.$,{onClick:em,loading:s,className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Schedule Posts"]})]})]})]}),b&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Generating monthly content..."}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"This may take a few moments. Please wait."})]})]})}),(0,a.jsx)("div",{className:"space-y-6",children:e.filter(e=>e.selectedImages&&e.selectedImages.length>0||e.selectedImage).map(e=>(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 bg-white shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-lg",children:e.scheduledFor?eu(e.scheduledFor):"Not scheduled"})}),(0,a.jsx)("div",{className:"mb-6",children:e.selectedImages&&e.selectedImages.length>0?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"flex gap-4",children:e.selectedImages.map((t,s)=>(0,a.jsxs)("div",{className:"relative",children:[Y[e.id]?.[s]&&(0,a.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:Y[e.id][s]}),(0,a.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[t.mime_type&&t.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:t.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,a.jsx)("img",{src:H[e.id]?.[s]&&X[e.id]?.[s]?X[e.id][s]:t.file_path,alt:`Preview ${s+1}`,className:"w-full h-full object-cover"}),!(t.mime_type&&t.mime_type.startsWith("video/"))&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:H[e.id]?.[s]?(0,a.jsx)("button",{onClick:()=>ef(e.id,s),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,a.jsx)("button",{onClick:()=>eb(e.id,t.file_path,e.caption,s),disabled:G[e.id]?.[s],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:G[e.id]?.[s]?"Enhancing...":"Enhance"})})]})]},t.id||s))})}):e.selectedImage?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"relative",children:[Y[e.id]?.[0]&&(0,a.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:Y[e.id][0]}),(0,a.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[e.selectedImage.mime_type&&e.selectedImage.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:e.selectedImage.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,a.jsx)("img",{src:H[e.id]?.[0]&&X[e.id]?.[0]?X[e.id][0]:e.selectedImage.file_path,alt:"Selected",className:"w-full h-full object-cover"}),!(e.selectedImage.mime_type&&e.selectedImage.mime_type.startsWith("video/"))&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:H[e.id]?.[0]?(0,a.jsx)("button",{onClick:()=>ef(e.id,0),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,a.jsx)("button",{onClick:()=>eb(e.id,e.selectedImage.file_path,e.caption,0),disabled:G[e.id]?.[0],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:G[e.id]?.[0]?"Enhancing...":"Enhance"})})]})]})}):(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"w-64 h-80 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"No images selected"})})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caption"}),$!==e.id&&(0,a.jsx)("button",{onClick:()=>ep(e.id,e.caption,e.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),$===e.id?(0,a.jsx)("textarea",{value:L,onChange:e=>T(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs",rows:3}):(0,a.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:e.caption})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags"}),$!==e.id&&(0,a.jsx)("button",{onClick:()=>ep(e.id,e.caption,e.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),$===e.id?(0,a.jsx)(c.p,{value:q,onChange:e=>R(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:e.hashtags&&e.hashtags.length>0?e.hashtags.map(e=>`#${e}`).join(" "):""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled For"}),$!==e.id&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>ep(e.id,e.caption,e.hashtags,e.scheduledFor),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),e.scheduledFor&&(0,a.jsx)("button",{onClick:()=>ei(e.id),className:"text-xs text-green-600 hover:text-green-800",children:"Quick Time"})]}),$===e.id?(0,a.jsx)("input",{type:"datetime-local",value:W||(e.scheduledFor?new Date(e.scheduledFor).toISOString().slice(0,16):eh(e.day.toString(),ea).slice(0,16)),onChange:e=>J(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):el===e.id?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"time",value:e.scheduledFor?new Date(e.scheduledFor).toLocaleTimeString("en-GB",{hour12:!1}):ea,onChange:t=>{ex(e.id,t.target.value),ei(null)},className:"px-2 py-1 border border-gray-300 rounded text-xs focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,a.jsx)("button",{onClick:()=>ei(null),className:"text-xs text-gray-500 hover:text-gray-700",children:"Cancel"})]}):(0,a.jsx)("p",{className:"text-sm text-gray-900",children:e.scheduledFor?eu(e.scheduledFor):"Not scheduled"})]})]})]},e.id))})]})]})]})}},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},93643:(e,t,s)=>{Promise.resolve().then(s.bind(s,69842))},94735:e=>{"use strict";e.exports=require("events")},96241:(e,t,s)=>{"use strict";s.d(t,{cn:()=>l});var a=s(49384),r=s(82348);function l(...e){return(0,r.QP)((0,a.$)(e))}async function i(e){try{console.log("\uD83D\uDD04 Trying fallback HEIC conversion...");let t=await fetch(e),s=await t.blob(),a=document.createElement("canvas"),r=a.getContext("2d");if(!r)throw Error("Canvas context not available");let l=new Image;return new Promise((e,t)=>{l.onload=()=>{try{a.width=l.width,a.height=l.height,r.drawImage(l,0,0);let t=a.toDataURL("image/jpeg",.9);console.log("✅ Fallback HEIC conversion successful"),e(t)}catch(e){console.error("❌ Fallback conversion failed:",e),t(e)}},l.onerror=()=>{console.error("❌ Failed to load image for fallback conversion"),t(Error("Failed to load image"))},l.src=URL.createObjectURL(s)})}catch(e){throw console.error("❌ Fallback HEIC conversion failed:",e),e}}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[4447,3078,1658,9522,9069,5814,6100],()=>s(51319));module.exports=a})();