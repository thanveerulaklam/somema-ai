(()=>{var e={};e.id=4672,e.ids=[4672],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},16952:(e,r,s)=>{"use strict";s.r(r),s.d(r,{patchFetch:()=>b,routeModule:()=>d,serverHooks:()=>q,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>h});var t={};s.r(t),s.d(t,{POST:()=>m});var i=s(96559),o=s(48088),u=s(37719),a=s(32190),n=s(66437),l=s(29021),p=s.n(l),c=s(33873),f=s.n(c);let x=(0,n.UU)("https://yfmypikqgegvookjzvyv.supabase.co",process.env.SUPABASE_SERVICE_ROLE_KEY);async function m(e){try{console.log("\uD83D\uDD27 Fixing user_profiles table...");let e=f().join(process.cwd(),"fix-user-profiles-table.sql");if(!p().existsSync(e))return a.NextResponse.json({error:"Fix SQL file not found",path:e},{status:404});let r=p().readFileSync(e,"utf8");console.log("\uD83D\uDCCB Executing fix SQL...");let s=r.split(";").map(e=>e.trim()).filter(e=>e.length>0&&!e.startsWith("--")),t=[],i=[];for(let e of s)try{if(e.trim()){let{data:r,error:s}=await x.rpc("exec_sql",{sql:e+";"});s?s.message.includes("already exists")||s.message.includes("relation")||s.message.includes("function")||s.message.includes("trigger")||i.push({statement:e.substring(0,100)+"...",error:s.message}):t.push({statement:e.substring(0,100)+"...",success:!0})}}catch(r){i.push({statement:e.substring(0,100)+"...",error:r instanceof Error?r.message:"Unknown error"})}console.log("\uD83D\uDD0D Verifying table structure...");let{data:o,error:u}=await x.from("information_schema.columns").select("column_name, data_type, is_nullable, column_default").eq("table_name","user_profiles").eq("table_schema","public");u&&i.push({statement:"Table structure verification",error:u.message});let n=0===i.length;return console.log("✅ User profiles table fix completed!"),a.NextResponse.json({success:n,message:n?"User profiles table fixed successfully!":"User profiles table fix completed with some warnings",results:{statementsExecuted:t.length,errors:i.length,tableColumns:o||[]},details:{successfulStatements:t,errors:i,tableStructure:o}})}catch(e){return console.error("❌ Fix failed:",e),a.NextResponse.json({error:"User profiles table fix failed",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}let d=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/fix-user-profiles/route",pathname:"/api/fix-user-profiles",filename:"route",bundlePath:"app/api/fix-user-profiles/route"},resolvedPagePath:"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/api/fix-user-profiles/route.ts",nextConfigOutput:"",userland:t}),{workAsyncStorage:g,workUnitAsyncStorage:h,serverHooks:q}=d;function b(){return(0,u.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:h})}},27910:e=>{"use strict";e.exports=require("stream")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78335:()=>{},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),t=r.X(0,[4447,580,6437],()=>s(16952));module.exports=t})();