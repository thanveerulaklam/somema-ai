(()=>{var e={};e.id=3175,e.ids=[3175],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9389:(e,s,t)=>{Promise.resolve().then(t.bind(t,64971))},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},12294:(e,s,t)=>{"use strict";t.d(s,{$:()=>o});var r=t(60687),i=t(43210),a=t.n(i),n=t(96241);let o=a().forwardRef(({className:e,variant:s="primary",size:t="md",loading:i=!1,children:a,disabled:o,...l},c)=>(0,r.jsxs)("button",{className:(0,n.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-50",ghost:"text-gray-900 hover:bg-gray-100",destructive:"bg-red-600 text-white hover:bg-red-700 border border-red-600"}[s],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[t],e),ref:c,disabled:o||i,...l,children:[i&&(0,r.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a]}));o.displayName="Button"},16396:(e,s,t)=>{"use strict";t.d(s,{$G:()=>i,ND:()=>r});let r=(0,t(59522).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),i=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},39727:()=>{},45773:(e,s,t)=>{Promise.resolve().then(t.bind(t,94904))},46055:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});var r=t(31658);let i=async e=>[{type:"image/x-icon",sizes:"500x500",url:(0,r.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64971:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>l});var r=t(60687),i=t(43210),a=t(16189);t(16396);var n=t(12294);function o({userId:e}){let[s,t]=(0,i.useState)([]),[a,o]=(0,i.useState)(!0),[l,c]=(0,i.useState)(null),[d,m]=(0,i.useState)("all"),[u,p]=(0,i.useState)({total:0,limit:10,offset:0,hasMore:!1}),x=async(s=0,r="all")=>{try{o(!0),c(null);let i=new URLSearchParams({userId:e,limit:u.limit.toString(),offset:s.toString()});"all"!==r&&i.append("status",r);let a=await fetch(`/api/invoices/list?${i}`),n=await a.json();n.success?(0===s?t(n.invoices):t(e=>[...e,...n.invoices]),p(n.pagination)):c(n.error||"Failed to fetch invoices")}catch(e){console.error("Error fetching invoices:",e),c("Failed to fetch invoices")}finally{o(!1)}},h=async e=>{try{let s=await fetch("/api/invoices/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({invoiceId:e})}),t=await s.json();t.success?(x(0,d),alert("Invoice sent successfully!")):alert("Failed to send invoice: "+t.error)}catch(e){console.error("Error sending invoice:",e),alert("Failed to send invoice")}},v=e=>(e/100).toFixed(2),g=e=>new Date(e).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),b=e=>{switch(e){case"paid":return"bg-green-100 text-green-800";case"sent":return"bg-blue-100 text-blue-800";case"draft":default:return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";case"expired":return"bg-yellow-100 text-yellow-800"}};return a&&0===s.length?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l?(0,r.jsxs)("div",{className:"text-center p-8",children:[(0,r.jsx)("p",{className:"text-red-600 mb-4",children:l}),(0,r.jsx)(n.$,{onClick:()=>x(0,d),children:"Try Again"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"Invoices"}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsxs)("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"all",children:"All Status"}),(0,r.jsx)("option",{value:"draft",children:"Draft"}),(0,r.jsx)("option",{value:"sent",children:"Sent"}),(0,r.jsx)("option",{value:"paid",children:"Paid"}),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,r.jsx)("option",{value:"expired",children:"Expired"})]})})]}),0===s.length?(0,r.jsx)("div",{className:"text-center p-8 bg-gray-50 rounded-lg",children:(0,r.jsx)("p",{className:"text-gray-600",children:"No invoices found"})}):(0,r.jsx)("div",{className:"space-y-4",children:s.map(e=>(0,r.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Invoice #",e.invoice_number]}),(0,r.jsxs)("p",{className:"text-gray-600",children:[e.customer_name," (",e.customer_email,")"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:[e.plan_id," - ",e.billing_cycle]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${b(e.status)}`,children:e.status.toUpperCase()}),(0,r.jsxs)("p",{className:"text-lg font-bold mt-1",children:["₹",v(e.total_amount)]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Base Amount"}),(0,r.jsxs)("p",{className:"font-medium",children:["₹",v(e.base_amount)]})]}),e.tax_amount>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Tax Amount"}),(0,r.jsxs)("p",{className:"font-medium",children:["₹",v(e.tax_amount)]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Due Date"}),(0,r.jsx)("p",{className:"font-medium",children:g(e.due_date)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-500",children:"Created"}),(0,r.jsx)("p",{className:"font-medium",children:g(e.created_at)})]})]}),e.invoice_items&&e.invoice_items.length>0&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Items:"}),(0,r.jsx)("div",{className:"space-y-1",children:e.invoice_items.map(e=>(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:e.item_name}),(0,r.jsxs)("span",{children:["₹",v(e.total_price)]})]},e.id))})]}),(0,r.jsxs)("div",{className:"flex justify-end space-x-2",children:["draft"===e.status&&(0,r.jsx)(n.$,{onClick:()=>h(e.id),size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:"Send Invoice"}),"sent"===e.status&&(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.$,{onClick:()=>window.open(`https://invoice.razorpay.com/invoice/${e.razorpay_invoice_id}`,"_blank"),size:"sm",variant:"outline",children:"View Invoice"})}),"paid"===e.status&&(0,r.jsxs)("div",{className:"flex items-center text-green-600 text-sm",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Paid on ",g(e.paid_at)]})]})]},e.id))}),u.hasMore&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(n.$,{onClick:()=>{u.hasMore&&x(u.offset+u.limit,d)},disabled:a,variant:"outline",children:a?"Loading...":"Load More"})})]})}function l(){let e=(0,a.useRouter)(),[s,t]=(0,i.useState)(null),[l,c]=(0,i.useState)(!0);return l?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Invoice Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your invoices and billing"})]}),(0,r.jsx)(n.$,{onClick:()=>e.push("/pricing"),className:"bg-blue-600 hover:bg-blue-700",children:"Create New Invoice"})]}),(0,r.jsx)(o,{userId:s.id})]})}):null}},72467:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>m,pages:()=>d,routeModule:()=>u,tree:()=>c});var r=t(65239),i=t(48088),a=t(88170),n=t.n(a),o=t(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(s,l);let c={children:["",{children:["invoices",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,94904)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/invoices/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/invoices/page.tsx"],m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/invoices/page",pathname:"/invoices",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")},94904:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/invoices/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/invoices/page.tsx","default")},96241:(e,s,t)=>{"use strict";t.d(s,{cn:()=>a});var r=t(49384),i=t(82348);function a(...e){return(0,i.QP)((0,r.$)(e))}async function n(e){try{console.log("\uD83D\uDD04 Trying fallback HEIC conversion...");let s=await fetch(e),t=await s.blob(),r=document.createElement("canvas"),i=r.getContext("2d");if(!i)throw Error("Canvas context not available");let a=new Image;return new Promise((e,s)=>{a.onload=()=>{try{r.width=a.width,r.height=a.height,i.drawImage(a,0,0);let s=r.toDataURL("image/jpeg",.9);console.log("✅ Fallback HEIC conversion successful"),e(s)}catch(e){console.error("❌ Fallback conversion failed:",e),s(e)}},a.onerror=()=>{console.error("❌ Failed to load image for fallback conversion"),s(Error("Failed to load image"))},a.src=URL.createObjectURL(t)})}catch(e){throw console.error("❌ Fallback HEIC conversion failed:",e),e}}}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[4447,3078,1658,9522,9069,6100],()=>t(72467));module.exports=r})();