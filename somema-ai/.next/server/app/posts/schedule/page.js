(()=>{var e={};e.id=4382,e.ids=[4382],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},16396:(e,t,s)=>{"use strict";s.d(t,{$G:()=>r,ND:()=>a});let a=(0,s(59522).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),r=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37461:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/posts/schedule/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/posts/schedule/page.tsx","default")},39727:()=>{},46055:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(31658);let r=async e=>[{type:"image/x-icon",sizes:"500x500",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},47869:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>d});var a=s(65239),r=s(48088),l=s(88170),i=s.n(l),n=s(30893),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d={children:["",{children:["posts",{children:["schedule",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,37461)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/posts/schedule/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,58014)),"/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/Users/thanveerulaklam/Desktop/Projects/Somema/somema-ai/app/posts/schedule/page.tsx"],m={require:s,loadChunk:()=>Promise.resolve()},u=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/posts/schedule/page",pathname:"/posts/schedule",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},47990:()=>{},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},61218:(e,t,s)=>{Promise.resolve().then(s.bind(s,37461))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},65175:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(60687),r=s(43210),l=s(16189),i=s(16396);function n(){let[e,t]=(0,r.useState)("single"),[s,n]=(0,r.useState)([]),[o,d]=(0,r.useState)([]),[c,m]=(0,r.useState)([]),[u,h]=(0,r.useState)(1),[p,x]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null),b=(0,l.useRouter)(),[y,v]=(0,r.useState)(!1),[j,w]=(0,r.useState)(null),[N,S]=(0,r.useState)(null),[k,I]=(0,r.useState)([]),[_,D]=(0,r.useState)(null),[C,P]=(0,r.useState)({}),[q,M]=(0,r.useState)(null),[O,z]=(0,r.useState)({}),E=t=>{"single"===e?d([t]):"week"===e?null!==_&&P({...C,[_]:t}):"month"===e?q&&z({...O,[q]:t}):o.includes(t)?d(o.filter(e=>e!==t)):o.length<A()&&d([...o,t])},A=()=>"single"===e?1:"week"===e?s.length||7:"month"===e?s.length||30:1,J=(()=>{let e=new Date,t=e.getFullYear(),s=e.getMonth(),a=new Date(t,s,1),r=new Date(t,s+1,0).getDate(),l=a.getDay(),i=[];for(let e=0;e<l;e++)i.push(null);for(let e=1;e<=r;e++){let a=new Date(t,s,e),r=a.toLocaleDateString("en-US",{weekday:"short"});i.push({day:r,date:a.toISOString().slice(0,10)})}for(;i.length%7!=0;)i.push(null);return i})(),U="week"===e?Object.values(C).filter(Boolean).length:"month"===e?Object.values(O).filter(Boolean).length:o.length,T="week"===e?7:"month"===e?J.filter(Boolean).length:A(),R=async()=>{x(!0),f(null);try{let t=o,a=s,r={};"week"===e?(t=[],a=[],Object.entries(C).forEach(([e,s])=>{s&&!isNaN(Number(e))&&(t.push(s),a.push(Number(e)),r[s]=B[Number(e)].date)})):"month"===e&&(t=[],a=[],Object.entries(O).forEach(([e,s])=>{s&&(t.push(s),a.push(e),r[s]=e)}));let l={"Content-Type":"application/json"};N&&(l.Authorization=`Bearer ${N}`);let i=await fetch("/api/schedule-posts",{method:"POST",headers:l,body:JSON.stringify({images:t,schedule_type:e,selected_days:a,imageDateMap:r})});if(!i.ok){let e=await i.json();throw Error(e.error||"Failed to generate previews")}let n=await i.json();m(n.previews.map((e,s)=>({...e,media_url:e.media_url||e.image||t[s]}))),h(2)}catch(e){f(e.message||"Unknown error")}finally{x(!1)}},X=async()=>{v(!0),w(null);try{let e=c.map(e=>({...e,user_id:N,media_url:e.media_url,platform:e.platform||"instagram"})),{data:t}=await i.ND.auth.getSession(),s=t?.session?.access_token,a={"Content-Type":"application/json"};s&&(a.Authorization=`Bearer ${s}`);let r=await fetch("/api/save-scheduled-posts",{method:"POST",headers:a,body:JSON.stringify({posts:e})});if(!r.ok){let e=await r.json();throw Error(e.error||"Failed to save scheduled posts")}b.push("/dashboard?message="+encodeURIComponent("Posts scheduled successfully!"))}catch(e){w(e.message||"Unknown error")}finally{v(!1)}},B=(()=>{let e=new Date,t=[];for(let s=0;s<7;s++){let a=new Date(e);a.setDate(e.getDate()+s);let r=a.toLocaleDateString("en-US",{weekday:"short"});t.push({day:r,date:a.toISOString().slice(0,10)})}return t})();return(()=>{let e=new Date,t=e.getFullYear(),s=e.getMonth(),a=new Date(t,s+1,0),r=[];for(let e=1;e<=a.getDate();e++){let a=new Date(t,s,e),l=a.toLocaleDateString("en-US",{weekday:"short"});r.push({day:l,date:a.toISOString().slice(0,10)})}})(),(0,a.jsxs)("div",{className:"max-w-2xl mx-auto p-4",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Schedule Posts"}),1===u&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"font-semibold",children:"Schedule Type:"}),(0,a.jsxs)("select",{value:e,onChange:e=>{t(e.target.value),n([]),d([]),D(null),P({}),M(null),z({})},className:"ml-2 border rounded px-2 py-1",children:[(0,a.jsx)("option",{value:"single",children:"Single Day"}),(0,a.jsx)("option",{value:"week",children:"Week"}),(0,a.jsx)("option",{value:"month",children:"Month"})]})]}),"week"===e&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"font-semibold",children:"Select Days & Assign Images:"}),(0,a.jsx)("div",{className:"flex gap-4 mt-2",children:B.map((e,t)=>(0,a.jsxs)("button",{className:`flex flex-col items-center focus:outline-none ${_===t?"ring-2 ring-blue-500 ring-offset-2":""}`,onClick:()=>D(t),type:"button",children:[(0,a.jsx)("span",{className:"text-xs text-gray-700 mb-1",children:e.day}),(0,a.jsx)("div",{className:`w-24 h-24 rounded-lg border-2 flex items-center justify-center bg-gray-100 overflow-hidden mb-1 ${_===t?"border-blue-500":"border-gray-200"}`,children:C[t]?(0,a.jsx)("img",{src:C[t],alt:"Selected",className:"object-cover w-full h-full rounded-lg"}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"No Image"})}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.date})]},e.date))}),(0,a.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:"Click a day, then select an image below to assign it."})]}),"month"===e&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"font-semibold",children:"Select Days & Assign Images (Month):"}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2 mt-2",children:J.map((e,t)=>e?(0,a.jsxs)("button",{className:`flex flex-col items-center focus:outline-none ${q===e.date?"ring-2 ring-blue-500 ring-offset-2":""}`,onClick:()=>M(e.date),type:"button",children:[(0,a.jsx)("span",{className:"text-xs text-gray-700 mb-1",children:e.day}),(0,a.jsx)("div",{className:`w-24 h-24 rounded-lg border-2 flex items-center justify-center bg-gray-100 overflow-hidden mb-1 ${q===e.date?"border-blue-500":"border-gray-200"}`,children:O[e.date]?(0,a.jsx)("img",{src:O[e.date],alt:"Selected",className:"object-cover w-full h-full rounded-lg"}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"No Image"})}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1",children:e.date})]},e.date):(0,a.jsx)("div",{className:"w-24 h-24"},t))}),(0,a.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:"Click a day, then select an image below to assign it."})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"font-semibold",children:["Select Images","week"===e||"month"===e?" (assign to days)":` (max ${A()})`,":"]}),(0,a.jsxs)("div",{className:"flex gap-2 mt-2 flex-wrap",children:[0===k.length&&(0,a.jsx)("div",{className:"text-gray-500",children:"No images found in your media library."}),k.map((t,s)=>(0,a.jsx)("button",{className:`w-24 h-24 border-2 border-gray-200 rounded overflow-hidden flex items-center justify-center p-0 bg-gray-100 ${"week"===e?Object.values(C).includes(t.file_path)?"ring-2 ring-blue-500":"":"month"===e?Object.values(O).includes(t.file_path)?"ring-2 ring-blue-500":"":o.includes(t.file_path)?"ring-2 ring-blue-500":""}`,onClick:()=>E(t.file_path),disabled:"week"===e?null===_:"month"===e?null===q:"single"!==e&&o.length>=A()&&!o.includes(t.file_path),type:"button",children:t.mime_type&&t.mime_type.startsWith("video/")||t.file_path.match(/\.(mp4|webm|mov)$/i)?(0,a.jsx)("video",{src:t.file_path,className:"object-cover w-full h-full",style:{minWidth:0,minHeight:0}}):(0,a.jsx)("img",{src:t.file_path,alt:t.file_name,className:"object-cover w-full h-full",style:{minWidth:0,minHeight:0},onError:e=>{e.currentTarget.style.display="none"}})},t.id))]}),"week"===e&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Selected day: ",null!==_?B[_]?.day:"None"]}),"month"===e&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Selected day: ",q||"None"]}),"week"!==e&&"month"!==e&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Selected: ",o.length]})]}),g&&(0,a.jsx)("div",{className:"text-red-600 mb-2",children:g}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded disabled:opacity-50",disabled:0===U||p,onClick:R,children:p?"Generating...":"Generate Previews"})]}),2===u&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Preview Scheduled Posts"}),(0,a.jsx)("div",{className:"space-y-8",children:c.map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 items-start border rounded-lg p-4 bg-white shadow-sm",children:[(0,a.jsxs)("div",{className:"w-full max-w-xs mx-auto md:mx-0",children:[(0,a.jsx)("div",{className:"bg-black rounded-t-lg overflow-hidden aspect-square w-full flex items-center justify-center",children:e.media_url&&e.media_url.match(/\.(mp4|webm|mov)$/i)?(0,a.jsx)("video",{src:e.media_url,controls:!0,className:"object-cover w-full h-full",style:{aspectRatio:"1/1"}}):(0,a.jsx)("img",{src:e.media_url,alt:"Preview",className:"object-cover w-full h-full",style:{aspectRatio:"1/1"}})}),(0,a.jsxs)("div",{className:"bg-white rounded-b-lg border-t px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)("span",{className:"w-8 h-8 rounded-full bg-gradient-to-tr from-pink-500 via-red-500 to-yellow-500 flex items-center justify-center text-white font-bold text-lg",children:"IG"}),(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:"YourBrand"}),(0,a.jsxs)("span",{className:"text-xs text-gray-400 ml-auto",children:["Scheduled: ",new Date(e.scheduledDate).toLocaleString()]})]}),(0,a.jsx)("div",{className:"text-gray-900 whitespace-pre-line",style:{wordBreak:"break-word"},children:e.caption})]})]}),(0,a.jsxs)("div",{className:"flex-1 w-full md:w-1/2",children:[(0,a.jsx)("label",{className:"block font-semibold mb-1",children:"Edit Caption"}),(0,a.jsx)("textarea",{className:"border px-3 py-2 rounded w-full min-h-[120px] resize-vertical",value:e.caption,onChange:e=>{let s=[...c];s[t].caption=e.target.value,m(s)}})]})]},t))}),j&&(0,a.jsx)("div",{className:"text-red-600 mt-2",children:j}),(0,a.jsx)("button",{className:"mt-6 bg-green-600 text-white px-6 py-2 rounded disabled:opacity-50",onClick:X,disabled:y,children:y?"Scheduling...":"Confirm Schedule"})]}),"week"===e&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Scheduled: ",U," / 7 days"]}),"month"===e&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-gray-500",children:["Scheduled: ",U," / ",T," days"]})]})}Array.from({length:31},(e,t)=>t+1)},74075:e=>{"use strict";e.exports=require("zlib")},79370:(e,t,s)=>{Promise.resolve().then(s.bind(s,65175))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[4447,3078,1658,9522,6100],()=>s(47869));module.exports=a})();