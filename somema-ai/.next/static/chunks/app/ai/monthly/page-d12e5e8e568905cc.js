(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4995],{646:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3168:(e,t,s)=>{"use strict";s.d(t,{$G:()=>l,ND:()=>a});let a=(0,s(3865).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),l=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},3311:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},3999:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});var a=s(2596),l=s(9688);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,l.QP)((0,a.$)(t))}async function i(e){try{console.log("\uD83D\uDD04 Trying fallback HEIC conversion...");let t=await fetch(e),s=await t.blob(),a=document.createElement("canvas"),l=a.getContext("2d");if(!l)throw Error("Canvas context not available");let r=new Image;return new Promise((e,t)=>{r.onload=()=>{try{a.width=r.width,a.height=r.height,l.drawImage(r,0,0);let t=a.toDataURL("image/jpeg",.9);console.log("✅ Fallback HEIC conversion successful"),e(t)}catch(e){console.error("❌ Fallback conversion failed:",e),t(e)}},r.onerror=()=>{console.error("❌ Failed to load image for fallback conversion"),t(Error("Failed to load image"))},r.src=URL.createObjectURL(s)})}catch(e){throw console.error("❌ Fallback HEIC conversion failed:",e),e}}},4746:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var a=s(5155),l=s(2115),r=s(5695),i=s(6874),n=s.n(i),d=s(3168),o=s(4912),c=s(6076),m=s(7550),u=s(9074),h=s(7213),g=s(3311),x=s(646);let p=e=>{let{src:t,fileName:s,className:r}=e,i=(0,l.useRef)(null),[n,d]=(0,l.useState)(!1),[o,c]=(0,l.useState)(!1),[m,u]=(0,l.useState)(!0),[h,g]=(0,l.useState)(!1),x=()=>{i.current&&(i.current.muted=!i.current.muted,u(i.current.muted))};return o?(0,a.jsx)("div",{className:"".concat(r," bg-gray-200 flex items-center justify-center group relative overflow-hidden"),children:(0,a.jsxs)("div",{className:"text-gray-500 text-center",children:[(0,a.jsx)("div",{className:"text-lg mb-1",children:"\uD83C\uDFA5"}),(0,a.jsx)("div",{className:"text-xs",children:"Video Error"}),(0,a.jsx)("div",{className:"text-xs opacity-75 mt-1 truncate max-w-full px-2",children:s})]})}):(0,a.jsxs)("div",{className:"".concat(r," bg-gray-200 flex items-center justify-center group relative overflow-hidden cursor-pointer"),onClick:()=>{i.current&&(n?i.current.pause():i.current.play().catch(console.error))},onMouseEnter:()=>g(!0),onMouseLeave:()=>{g(!1),i.current&&n&&i.current.pause()},children:[(0,a.jsx)("video",{ref:i,src:t,className:"w-full h-full object-cover",muted:m,playsInline:!0,loop:!0,onPlay:()=>{d(!0)},onPause:()=>{d(!1)},onError:()=>{c(!0)},onMouseEnter:e=>{e.currentTarget.play().catch(console.error)}}),!n&&(0,a.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center",children:(0,a.jsx)("div",{className:"bg-white bg-opacity-95 backdrop-blur-sm rounded-full p-2 shadow-2xl hover:bg-opacity-100 hover:scale-110 transition-all duration-200 cursor-pointer",children:(0,a.jsx)("svg",{className:"w-4 h-4 text-gray-800 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M8 5v14l11-7z"})})})}),n&&h&&(0,a.jsx)("div",{className:"absolute top-2 right-2",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:(0,a.jsx)("div",{onClick:e=>{e.stopPropagation(),x()},className:"bg-black bg-opacity-70 hover:bg-opacity-90 rounded-full p-1.5 shadow-lg hover:scale-110 transition-all duration-200 backdrop-blur-sm cursor-pointer",title:m?"Unmute":"Mute",children:m?(0,a.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})}):(0,a.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})})}),(0,a.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate",children:s})]})};function b(){let[e,t]=(0,l.useState)([]),[s,i]=(0,l.useState)(!1),[b,f]=(0,l.useState)(!1),[y,v]=(0,l.useState)("instagram"),[j,w]=(0,l.useState)(""),[N,I]=(0,l.useState)(""),[k,_]=(0,l.useState)([]),[S,C]=(0,l.useState)(!1),[A,M]=(0,l.useState)(""),[E,F]=(0,l.useState)({}),[D,P]=(0,l.useState)(null),[z,O]=(0,l.useState)(null),[L,R]=(0,l.useState)(null),[T,U]=(0,l.useState)(""),[W,J]=(0,l.useState)(""),[B,X]=(0,l.useState)(null),[Z,$]=(0,l.useState)({}),[G,H]=(0,l.useState)({}),[V,q]=(0,l.useState)({}),[Y,Q]=(0,l.useState)({}),[K,ee]=(0,l.useState)(!1),[et,es]=(0,l.useState)([]),[ea,el]=(0,l.useState)("11:00"),[er,ei]=(0,l.useState)(null),en=(0,r.useRouter)(),ed=function(){let e=[],t=new Date,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let l=1;l<=30;l++){let r=new Date(t);r.setDate(t.getDate()+l);let i=a[r.getDay()],n="".concat(r.getDate()," ").concat(s[r.getMonth()]," ").concat(r.getFullYear());e.push({day:i,date:n,dateObj:r})}return e}();(0,l.useEffect)(()=>{ec(),ef(),eo()},[]);let eo=async()=>{try{let{data:{user:e}}=await d.ND.auth.getUser();if(e){let{data:t}=await d.ND.from("user_profiles").select("*").eq("user_id",e.id).single();t?(console.log("Fetched user profile:",t),O(t)):console.log("No user profile found for user:",e.id)}}catch(e){console.error("Error fetching user profile:",e)}},ec=()=>{t(ed.map((e,t)=>({id:"day-".concat(t),week:Math.floor(t/7)+1,day:t+1,theme:"",caption:"",hashtags:[],imagePrompt:"",status:"pending"})))},em=async()=>{if(0===Object.values(E).flat().length)return void w("Please select at least one image to generate content");if(!z)return void w("Please complete your profile setup first");if(!z.business_name||""===z.business_name)return void w("Please complete your business profile setup first. Go to Settings to add your business details.");f(!0),w(""),I("");let{data:{user:s}}=await d.ND.auth.getUser();try{console.log("Sending userProfile to API:",z);let a=await fetch("/api/generate-monthly-content",{method:"POST",headers:{"Content-Type":"application/json",...(null==s?void 0:s.id)?{Authorization:"Bearer ".concat(s.id)}:{}},body:JSON.stringify({imageSelections:E,userProfile:z,platform:y})});if(!a.ok){let e=await a.json();throw Error(e.error||"Failed to generate content")}let l=await a.json();console.log("Generated monthly content:",l.generatedPosts);let r=e.map((e,t)=>{var s,a;let r=(null==(s=ed[t])?void 0:s.day)+" "+(null==(a=ed[t])?void 0:a.date),i=E[r];if(!i||0===i.length)return{...e,status:"pending",selectedImage:null};let n=l.generatedPosts.find(e=>e.dayKey===r);return n?{...e,theme:n.theme,caption:n.caption,hashtags:n.hashtags,imagePrompt:n.imagePrompt,status:"generated",selectedImage:n.selectedImages[0],selectedImages:n.selectedImages,scheduledFor:eg(e.day.toString(),ea)}:{...e,status:"pending",selectedImage:i[0]}});t(r),I("Monthly content generated successfully!"),F({}),ee(!0)}catch(e){console.error("Error generating monthly content:",e),w(e.message||"Failed to generate content. Please try again.")}finally{f(!1)}},eu=async()=>{i(!0),w("");try{let{data:{user:t}}=await d.ND.auth.getUser();if(!t)throw Error("User not authenticated");let s=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{var s,a,l,r,i;let n=e.selectedImages&&e.selectedImages.length>1,d=n?e.selectedImages.map((t,s)=>{var a;return(null==(a=G[e.id])?void 0:a[s])||t.file_path}):[],o=n?(null==(s=G[e.id])?void 0:s[0])||e.selectedImages[0].file_path:(null==(a=G[e.id])?void 0:a[0])||(null==(l=e.selectedImage)?void 0:l.file_path);return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"draft",scheduled_for:e.scheduledFor||eg(e.day.toString()),media_url:o,media_urls:d,enhanced_image_url:n?(null==(r=G[e.id])?void 0:r[0])||null:(null==(i=G[e.id])?void 0:i[0])||null,theme:e.theme,content_type:"monthly",business_context:"Day: ".concat(e.day,", Image Prompt: ").concat(e.imagePrompt)}});if(0===s.length)return void w("No posts to save. Please generate content first.");let{error:a}=await d.ND.from("posts").insert(s);if(a)throw a;I("Monthly content saved successfully!"),en.push("/dashboard")}catch(e){w(e.message)}finally{i(!1)}},eh=async()=>{i(!0),w("");try{let{data:{user:t}}=await d.ND.auth.getUser();if(!t)throw Error("User not authenticated");let s=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{var s,a,l,r,i;let n=e.selectedImages&&e.selectedImages.length>1,d=n?e.selectedImages.map((t,s)=>{var a;return(null==(a=G[e.id])?void 0:a[s])||t.file_path}):[],o=n?(null==(s=G[e.id])?void 0:s[0])||e.selectedImages[0].file_path:(null==(a=G[e.id])?void 0:a[0])||(null==(l=e.selectedImage)?void 0:l.file_path);return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"scheduled",scheduled_for:e.scheduledFor||eg(e.day.toString()),media_url:o,media_urls:d,enhanced_image_url:n?(null==(r=G[e.id])?void 0:r[0])||null:(null==(i=G[e.id])?void 0:i[0])||null,theme:e.theme,content_type:"monthly",business_context:"Day: ".concat(e.day,", Image Prompt: ").concat(e.imagePrompt)}});if(0===s.length)return void w("No posts to schedule. Please generate content first.");let{error:a}=await d.ND.from("posts").insert(s);if(a)throw a;I("Monthly content scheduled successfully!"),setTimeout(()=>{en.push("/calendar")},2e3)}catch(e){w(e.message)}finally{i(!1)}},eg=function(e){var t;let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ea,a=null==(t=ed[parseInt(e)-1])?void 0:t.dateObj;if(!a)return console.error("Invalid day number:",e),new Date().toISOString();let l=new Date(a),[r,i]=s.split(":").map(Number);return l.setHours(r,i,0,0),l.toISOString()},ex=e=>{let t=new Date(e);return t.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})+" at "+t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!1})},ep=e=>{t(t=>t.map(t=>({...t,scheduledFor:t.scheduledFor?eg(t.day.toString(),e):void 0})))},eb=(e,s)=>{t(t=>t.map(t=>t.id===e?{...t,scheduledFor:eg(t.day.toString(),s)}:t))},ef=async()=>{C(!0),M("");try{let{data:{user:e}}=await d.ND.auth.getUser();if(!e)return;let{data:t,error:s}=await d.ND.from("media").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;_(t||[])}catch(e){M(e.message)}finally{C(!1)}},ey=(e,t,s,a)=>{R(e),U(t),J(s.join(" ")),X(a?new Date(a).toISOString().slice(0,16):null)},ev=async(e,t,s,a)=>{$(t=>({...t,[e]:{...t[e]||{},[a]:!0}})),w(""),Q(t=>{let s={...t};return s[e]&&(delete s[e][a],0===Object.keys(s[e]).length&&delete s[e]),s});try{let l;if(t.startsWith("blob:")){let e=await fetch(t),s=await e.blob();l=new File([s],"image.jpg",{type:s.type})}else if(t.startsWith("data:")){let e=await fetch(t),s=await e.blob();l=new File([s],"image.jpg",{type:s.type})}else{let e=await fetch(t),s=await e.blob();l=new File([s],"image.jpg",{type:s.type})}let{data:{session:r}}=await d.ND.auth.getSession();if(!(null==r?void 0:r.access_token))throw Error("User not authenticated");let i=new FormData;i.append("image",l),i.append("productDescription",s);let n=await fetch("/api/enhance-image",{method:"POST",headers:{Authorization:"Bearer ".concat(r.access_token)},body:i});if(!n.ok){let e=await n.json();if("safety_violation"===e.errorType)throw Error("This image cannot be enhanced due to content policy restrictions. Please try with a different image.");throw Error(e.error||"Failed to enhance image")}let o=await n.json();H(t=>({...t,[e]:{...t[e]||{},[a]:o.enhancedImageUrl}})),q(t=>({...t,[e]:{...t[e]||{},[a]:!0}})),console.log("Image enhanced successfully:",o.enhancedImageUrl),void 0!==o.creditsRemaining&&(I("Image enhanced successfully! ".concat(o.creditsRemaining," enhancement credits remaining.")),setTimeout(()=>I(""),3e3))}catch(t){console.error("Error enhancing image:",t),Q(s=>({...s,[e]:{...s[e]||{},[a]:t.message||"Failed to enhance image"}}))}finally{$(t=>({...t,[e]:{...t[e]||{},[a]:!1}}))}},ej=(e,t)=>{q(s=>({...s,[e]:{...s[e]||{},[t]:!1}})),H(s=>{let a={...s};return a[e]&&(delete a[e][t],0===Object.keys(a[e]).length&&delete a[e]),a}),Q(s=>{let a={...s};return a[e]&&(delete a[e][t],0===Object.keys(a[e]).length&&delete a[e]),a})};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(n(),{href:"/dashboard",children:(0,a.jsxs)(o.$,{variant:"ghost",size:"sm",children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(u.A,{className:"h-6 w-6 text-green-600 mr-2"}),(0,a.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Monthly Content Generator"})]})]})})}),(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-4 lg:px-8 py-6 sm:py-8",children:[j&&(0,a.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-red-800 text-xs sm:text-sm",children:j})}),N&&(0,a.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,a.jsx)("p",{className:"text-green-800 text-xs sm:text-sm",children:N})}),!K&&(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6 mb-6 sm:mb-8",children:[(0,a.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Add Images for Each Day (Optional, up to 10 per day)"}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-6 lg:grid-cols-10 gap-2 sm:gap-4",children:ed.map(e=>{let{day:t,date:s}=e,l=t+" "+s;return(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)("span",{className:"font-medium text-gray-700 mb-1 text-xs",children:t}),(0,a.jsx)("span",{className:"text-xs text-gray-500 mb-2",children:s}),E[l]&&E[l].length>0?(0,a.jsxs)("div",{className:"relative group image-selected flex flex-wrap gap-1 justify-center",children:[E[l].map((e,s)=>(0,a.jsxs)("div",{className:"relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:e.file_path,className:"w-12 h-12 object-cover rounded shadow mb-1",muted:!0,playsInline:!0}):(0,a.jsx)("img",{src:e.file_path,alt:t,className:"w-12 h-12 object-cover rounded shadow mb-1"}),(0,a.jsx)("button",{className:"absolute top-0 right-0 bg-white bg-opacity-80 rounded-full p-0.5 text-red-500 hover:text-red-700 text-xs",onClick:()=>F(e=>({...e,[l]:e[l].filter((e,t)=>t!==s)})),"aria-label":"Remove image",children:"\xd7"})]},e.id)),E[l].length<10&&(0,a.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>P(l),className:"w-12 h-12 flex items-center justify-center",children:[(0,a.jsx)(h.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Add Image"})]}),E[l].length>1&&(0,a.jsx)("span",{className:"absolute bottom-0 left-0 bg-blue-600 text-white text-xs px-1 rounded",children:"Carousel"})]}):(0,a.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>P(l),children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"Select Image"]})]},l)})}),(0,a.jsx)("div",{className:"mt-6 sm:mt-8 flex gap-2 sm:gap-3 justify-center",children:(0,a.jsxs)(o.$,{onClick:em,disabled:0===Object.values(E).flat().length,loading:b,variant:"primary",className:"btn-generate",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 mr-2"}),b?"Generating Content...":"Generate Monthly Content"]})}),(0,a.jsx)("div",{className:"mt-3 text-sm text-gray-600 text-center",children:0===Object.values(E).flat().length?(0,a.jsx)("span",{className:"text-orange-600",children:"⚠️ Please select at least one image to enable generation"}):(0,a.jsxs)("span",{className:"text-green-600",children:["✅ ",Object.values(E).flat().length," image(s) selected"]})})]}),D&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-4xl w-full p-6 relative animate-fade-in",children:[(0,a.jsx)("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",onClick:()=>{P(null),es([])},"aria-label":"Close",children:"\xd7"}),(0,a.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Select Images for ",D.slice(0,D.indexOf(","))," ",D.slice(D.indexOf(",")+1)," (Up to 10)"]}),et.length>0&&(0,a.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Selected Images (",et.length,"/10)"]}),(0,a.jsx)("button",{onClick:()=>es([]),className:"text-xs text-red-600 hover:text-red-800",children:"Clear All"})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:et.map((e,t)=>(0,a.jsxs)("div",{className:"relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:e.file_path,className:"w-12 h-12 object-cover rounded",muted:!0,playsInline:!0}):(0,a.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-12 h-12 object-cover rounded"}),(0,a.jsx)("button",{onClick:()=>es(e=>e.filter((e,s)=>s!==t)),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"\xd7"})]},e.id))})]}),S?(0,a.jsx)("div",{className:"text-gray-500",children:"Loading media..."}):A?(0,a.jsx)("div",{className:"text-red-500",children:A}):(0,a.jsxs)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3 max-h-96 overflow-y-auto",children:[Array.isArray(k)&&k.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).map(e=>{let t=et.some(t=>t.id===e.id);return(0,a.jsxs)("button",{className:"focus:outline-none border-2 rounded overflow-hidden transition-all relative ".concat(t?"border-blue-500 bg-blue-50":"border-transparent hover:border-blue-300"),onClick:()=>{t?es(t=>t.filter(t=>t.id!==e.id)):et.length<10&&es(t=>[...t,e])},children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,a.jsx)(p,{src:e.file_path,fileName:e.file_name,className:"w-full h-20"}):(0,a.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-full h-20 object-cover"}),t&&(0,a.jsx)("div",{className:"absolute top-1 right-1 bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"✓"})]},e.id)}),(!Array.isArray(k)||Array.isArray(k)&&0===k.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).length)&&(0,a.jsx)("div",{className:"col-span-full text-gray-500",children:"No media found in your media library."})]}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,a.jsx)("button",{onClick:()=>{P(null),es([])},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,a.jsxs)("button",{onClick:()=>{F(e=>({...e,[D]:et})),P(null),es([])},disabled:0===et.length,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Add ",et.length," Image",1!==et.length?"s":""]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Monthly Content Preview"}),e.some(e=>"generated"===e.status)&&(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Default Time:"}),(0,a.jsx)("input",{type:"time",value:ea,onChange:e=>{el(e.target.value),ep(e.target.value)},className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)(o.$,{onClick:eu,loading:s,variant:"outline",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Save as Draft"]}),(0,a.jsxs)(o.$,{onClick:eh,loading:s,className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Schedule Posts"]})]})]})]}),b&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Generating monthly content..."}),(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"This may take a few moments. Please wait."})]})]})}),(0,a.jsx)("div",{className:"space-y-6",children:e.filter(e=>e.selectedImages&&e.selectedImages.length>0||e.selectedImage).map(e=>{var t,s,l,r,i,n;return(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 bg-white shadow-sm hover:shadow-md transition-shadow",children:[(0,a.jsx)("div",{className:"text-center mb-6",children:(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-lg",children:e.scheduledFor?ex(e.scheduledFor):"Not scheduled"})}),(0,a.jsx)("div",{className:"mb-6",children:e.selectedImages&&e.selectedImages.length>0?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"flex gap-4",children:e.selectedImages.map((t,s)=>{var l,r,i,n,d,o;return(0,a.jsxs)("div",{className:"relative",children:[(null==(l=Y[e.id])?void 0:l[s])&&(0,a.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:Y[e.id][s]}),(0,a.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[t.mime_type&&t.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:t.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,a.jsx)("img",{src:(null==(r=V[e.id])?void 0:r[s])&&(null==(i=G[e.id])?void 0:i[s])?G[e.id][s]:t.file_path,alt:"Preview ".concat(s+1),className:"w-full h-full object-cover"}),!(t.mime_type&&t.mime_type.startsWith("video/"))&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(null==(n=V[e.id])?void 0:n[s])?(0,a.jsx)("button",{onClick:()=>ej(e.id,s),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,a.jsx)("button",{onClick:()=>ev(e.id,t.file_path,e.caption,s),disabled:null==(d=Z[e.id])?void 0:d[s],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:(null==(o=Z[e.id])?void 0:o[s])?"Enhancing...":"Enhance"})})]})]},t.id||s)})})}):e.selectedImage?(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsxs)("div",{className:"relative",children:[(null==(t=Y[e.id])?void 0:t[0])&&(0,a.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:Y[e.id][0]}),(0,a.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[e.selectedImage.mime_type&&e.selectedImage.mime_type.startsWith("video/")?(0,a.jsx)("video",{src:e.selectedImage.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,a.jsx)("img",{src:(null==(s=V[e.id])?void 0:s[0])&&(null==(l=G[e.id])?void 0:l[0])?G[e.id][0]:e.selectedImage.file_path,alt:"Selected",className:"w-full h-full object-cover"}),!(e.selectedImage.mime_type&&e.selectedImage.mime_type.startsWith("video/"))&&(0,a.jsx)("div",{className:"absolute top-2 left-2",children:(null==(r=V[e.id])?void 0:r[0])?(0,a.jsx)("button",{onClick:()=>ej(e.id,0),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,a.jsx)("button",{onClick:()=>ev(e.id,e.selectedImage.file_path,e.caption,0),disabled:null==(i=Z[e.id])?void 0:i[0],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:(null==(n=Z[e.id])?void 0:n[0])?"Enhancing...":"Enhance"})})]})]})}):(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"w-64 h-80 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-gray-400 text-sm",children:"No images selected"})})})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caption"}),L!==e.id&&(0,a.jsx)("button",{onClick:()=>ey(e.id,e.caption,e.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),L===e.id?(0,a.jsx)("textarea",{value:T,onChange:e=>U(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs",rows:3}):(0,a.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:e.caption})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags"}),L!==e.id&&(0,a.jsx)("button",{onClick:()=>ey(e.id,e.caption,e.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),L===e.id?(0,a.jsx)(c.p,{value:W,onChange:e=>J(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):(0,a.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:e.hashtags&&e.hashtags.length>0?e.hashtags.map(e=>"#".concat(e)).join(" "):""})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled For"}),L!==e.id&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>ey(e.id,e.caption,e.hashtags,e.scheduledFor),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),e.scheduledFor&&(0,a.jsx)("button",{onClick:()=>ei(e.id),className:"text-xs text-green-600 hover:text-green-800",children:"Quick Time"})]}),L===e.id?(0,a.jsx)("input",{type:"datetime-local",value:B||(e.scheduledFor?new Date(e.scheduledFor).toISOString().slice(0,16):eg(e.day.toString(),ea).slice(0,16)),onChange:e=>X(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):er===e.id?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("input",{type:"time",value:e.scheduledFor?new Date(e.scheduledFor).toLocaleTimeString("en-GB",{hour12:!1}):ea,onChange:t=>{eb(e.id,t.target.value),ei(null)},className:"px-2 py-1 border border-gray-300 rounded text-xs focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,a.jsx)("button",{onClick:()=>ei(null),className:"text-xs text-gray-500 hover:text-gray-700",children:"Cancel"})]}):(0,a.jsx)("p",{className:"text-sm text-gray-900",children:e.scheduledFor?ex(e.scheduledFor):"Not scheduled"})]})]})]},e.id)})})]})]})]})}},4869:(e,t,s)=>{Promise.resolve().then(s.bind(s,4746))},4912:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(5155),l=s(2115),r=s(3999);let i=l.forwardRef((e,t)=>{let{className:s,variant:l="primary",size:i="md",loading:n=!1,children:d,disabled:o,...c}=e;return(0,a.jsxs)("button",{className:(0,r.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-50",ghost:"text-gray-900 hover:bg-gray-100",destructive:"bg-red-600 text-white hover:bg-red-700 border border-red-600"}[l],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[i],s),ref:t,disabled:o||n,...c,children:[n&&(0,a.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),d]})});i.displayName="Button"},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},6076:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(5155),l=s(2115),r=s(3999);let i=l.forwardRef((e,t)=>{let{className:s,type:i,label:n,error:d,helperText:o,id:c,...m}=e,u=(0,l.useId)(),h=c||"input-".concat(u);return(0,a.jsxs)("div",{className:"w-full",children:[n&&(0,a.jsx)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 mb-1",children:n}),(0,a.jsx)("input",{type:i,className:(0,r.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d&&"border-red-500 focus-visible:ring-red-500",s),ref:t,id:h,...m}),d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d}),o&&!d&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:o})]})});i.displayName="Input"},7213:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},7550:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},9074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9946:(e,t,s)=>{"use strict";s.d(t,{A:()=>m});var a=s(2115);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),r=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()),i=e=>{let t=r(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim()},d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,a.forwardRef)((e,t)=>{let{color:s="currentColor",size:l=24,strokeWidth:r=2,absoluteStrokeWidth:i,className:c="",children:m,iconNode:u,...h}=e;return(0,a.createElement)("svg",{ref:t,...o,width:l,height:l,stroke:s,strokeWidth:i?24*Number(r)/Number(l):r,className:n("lucide",c),...!m&&!d(h)&&{"aria-hidden":"true"},...h},[...u.map(e=>{let[t,s]=e;return(0,a.createElement)(t,s)}),...Array.isArray(m)?m:[m]])}),m=(e,t)=>{let s=(0,a.forwardRef)((s,r)=>{let{className:d,...o}=s;return(0,a.createElement)(c,{ref:r,iconNode:t,className:n("lucide-".concat(l(i(e))),"lucide-".concat(e),d),...o})});return s.displayName=i(e),s}}},e=>{var t=t=>e(e.s=t);e.O(0,[3865,4277,6874,8441,1684,7358],()=>t(4869)),_N_E=e.O()}]);