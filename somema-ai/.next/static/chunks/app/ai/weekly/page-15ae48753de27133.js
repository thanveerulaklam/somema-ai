(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1361],{646:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},3168:(e,t,a)=>{"use strict";a.d(t,{$G:()=>r,ND:()=>s});let s=(0,a(3865).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),r=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},3311:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},3667:(e,t,a)=>{Promise.resolve().then(a.bind(a,8338))},3999:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(2596),r=a(9688);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}async function i(e){try{console.log("\uD83D\uDD04 Trying fallback HEIC conversion...");let t=await fetch(e),a=await t.blob(),s=document.createElement("canvas"),r=s.getContext("2d");if(!r)throw Error("Canvas context not available");let l=new Image;return new Promise((e,t)=>{l.onload=()=>{try{s.width=l.width,s.height=l.height,r.drawImage(l,0,0);let t=s.toDataURL("image/jpeg",.9);console.log("✅ Fallback HEIC conversion successful"),e(t)}catch(e){console.error("❌ Fallback conversion failed:",e),t(e)}},l.onerror=()=>{console.error("❌ Failed to load image for fallback conversion"),t(Error("Failed to load image"))},l.src=URL.createObjectURL(a)})}catch(e){throw console.error("❌ Fallback HEIC conversion failed:",e),e}}},4912:(e,t,a)=>{"use strict";a.d(t,{$:()=>i});var s=a(5155),r=a(2115),l=a(3999);let i=r.forwardRef((e,t)=>{let{className:a,variant:r="primary",size:i="md",loading:n=!1,children:d,disabled:o,...c}=e;return(0,s.jsxs)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-50",ghost:"text-gray-900 hover:bg-gray-100",destructive:"bg-red-600 text-white hover:bg-red-700 border border-red-600"}[r],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[i],a),ref:t,disabled:o||n,...c,children:[n&&(0,s.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),d]})});i.displayName="Button"},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},6076:(e,t,a)=>{"use strict";a.d(t,{p:()=>i});var s=a(5155),r=a(2115),l=a(3999);let i=r.forwardRef((e,t)=>{let{className:a,type:i,label:n,error:d,helperText:o,id:c,...m}=e,u=(0,r.useId)(),h=c||"input-".concat(u);return(0,s.jsxs)("div",{className:"w-full",children:[n&&(0,s.jsx)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 mb-1",children:n}),(0,s.jsx)("input",{type:i,className:(0,l.cn)("flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm text-gray-900 ring-offset-white file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",d&&"border-red-500 focus-visible:ring-red-500",a),ref:t,id:h,...m}),d&&(0,s.jsx)("p",{className:"mt-1 text-sm text-red-600",children:d}),o&&!d&&(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:o})]})});i.displayName="Input"},7213:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},7550:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8338:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(5155),r=a(2115),l=a(5695),i=a(6874),n=a.n(i),d=a(3168),o=a(4912),c=a(6076),m=a(7550),u=a(9074),h=a(7213),g=a(3311),x=a(646);let p=e=>{let{src:t,fileName:a,className:l}=e,i=(0,r.useRef)(null),[n,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!0),[h,g]=(0,r.useState)(!1),x=()=>{i.current&&(i.current.muted=!i.current.muted,u(i.current.muted))};return o?(0,s.jsx)("div",{className:"".concat(l," bg-gray-200 flex items-center justify-center group relative overflow-hidden"),children:(0,s.jsxs)("div",{className:"text-gray-500 text-center",children:[(0,s.jsx)("div",{className:"text-lg mb-1",children:"\uD83C\uDFA5"}),(0,s.jsx)("div",{className:"text-xs",children:"Video Error"}),(0,s.jsx)("div",{className:"text-xs opacity-75 mt-1 truncate max-w-full px-2",children:a})]})}):(0,s.jsxs)("div",{className:"".concat(l," bg-gray-200 flex items-center justify-center group relative overflow-hidden cursor-pointer"),onClick:()=>{i.current&&(n?i.current.pause():i.current.play().catch(console.error))},onMouseEnter:()=>g(!0),onMouseLeave:()=>{g(!1),i.current&&n&&i.current.pause()},children:[(0,s.jsx)("video",{ref:i,src:t,className:"w-full h-full object-cover",muted:m,playsInline:!0,loop:!0,onPlay:()=>{d(!0)},onPause:()=>{d(!1)},onError:()=>{c(!0)},onMouseEnter:e=>{e.currentTarget.play().catch(console.error)}}),!n&&(0,s.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center",children:(0,s.jsx)("div",{className:"bg-white bg-opacity-95 backdrop-blur-sm rounded-full p-2 shadow-2xl hover:bg-opacity-100 hover:scale-110 transition-all duration-200 cursor-pointer",children:(0,s.jsx)("svg",{className:"w-4 h-4 text-gray-800 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M8 5v14l11-7z"})})})}),n&&h&&(0,s.jsx)("div",{className:"absolute top-2 right-2",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:(0,s.jsx)("div",{onClick:e=>{e.stopPropagation(),x()},className:"bg-black bg-opacity-70 hover:bg-opacity-90 rounded-full p-1.5 shadow-lg hover:scale-110 transition-all duration-200 backdrop-blur-sm cursor-pointer",title:m?"Unmute":"Mute",children:m?(0,s.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"})}):(0,s.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"})})})}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-1 truncate",children:a})]})};function b(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[y,v]=(0,r.useState)("instagram"),[j,w]=(0,r.useState)(""),[N,I]=(0,r.useState)(""),[k,S]=(0,r.useState)([]),[_,C]=(0,r.useState)(!1),[A,M]=(0,r.useState)(""),[D,F]=(0,r.useState)({}),[E,O]=(0,r.useState)(null),[P,z]=(0,r.useState)(null),[W,T]=(0,r.useState)(null),[R,L]=(0,r.useState)(""),[U,J]=(0,r.useState)(""),[H,B]=(0,r.useState)(null),[X,Z]=(0,r.useState)({}),[$,V]=(0,r.useState)({}),[G,Y]=(0,r.useState)({}),[q,Q]=(0,r.useState)({}),[K,ee]=(0,r.useState)(!1),[et,ea]=(0,r.useState)([]),[es,er]=(0,r.useState)("11:00"),el=(0,l.useRouter)(),ei=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];(0,r.useEffect)(()=>{ed(),eh(),en()},[]);let en=async()=>{try{let{data:{user:e}}=await d.ND.auth.getUser();if(e){let{data:t}=await d.ND.from("user_profiles").select("*").eq("user_id",e.id).single();t?(console.log("Fetched user profile:",t),z(t)):console.log("No user profile found for user:",e.id)}}catch(e){console.error("Error fetching user profile:",e)}},ed=()=>{t(ei.map((e,t)=>({id:"day-".concat(t),day:e,theme:"",caption:"",hashtags:[],imagePrompt:"",status:"pending"})))},eo=async()=>{if(0===Object.values(D).flat().length)return void w("Please select at least one image to generate content");if(!P)return void w("Please complete your profile setup first");if(!P.business_name||""===P.business_name)return void w("Please complete your business profile setup first. Go to Settings to add your business details.");f(!0),w(""),I("");let{data:{user:a}}=await d.ND.auth.getUser();try{console.log("Sending userProfile to API:",P);let s=await fetch("/api/generate-weekly-content",{method:"POST",headers:{"Content-Type":"application/json",...(null==a?void 0:a.id)?{Authorization:"Bearer ".concat(a.id)}:{}},body:JSON.stringify({imageSelections:D,userProfile:P,platform:y})});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to generate content")}let r=await s.json();console.log("Generated weekly content:",r.generatedPosts);let l=e.map((e,t)=>{var a,s,l;let i=(null==(a=ev[t])?void 0:a.day)+(null==(s=ev[t])?void 0:s.date),n=D[i];if(!n||0===n.length)return{...e,status:"pending",selectedImage:null};let d=r.generatedPosts.find(e=>e.dayKey===i);if(d){let a=null==(l=ev[t])?void 0:l.dateObj;if(a){let[e,t]=es.split(":").map(Number);a.setHours(e,t,0,0)}return{...e,theme:d.theme,caption:d.caption,hashtags:d.hashtags,imagePrompt:d.imagePrompt,status:"generated",selectedImage:d.selectedImages[0],selectedImages:d.selectedImages,scheduledFor:a?a.toISOString():eu(e.day,es)}}return{...e,status:"pending",selectedImage:n[0]}});t(l),I("Weekly content generated successfully!"),F({}),ee(!0)}catch(e){console.error("Error generating weekly content:",e),w(e.message||"Failed to generate content. Please try again.")}finally{f(!1)}},ec=async()=>{i(!0),w("");try{let{data:{user:t}}=await d.ND.auth.getUser();if(!t)throw Error("User not authenticated");let a=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{var a,s,r,l,i;let n=e.selectedImages&&e.selectedImages.length>1,d=n?e.selectedImages.map((t,a)=>{var s;return(null==(s=$[e.id])?void 0:s[a])||t.file_path}):[],o=n?(null==(a=$[e.id])?void 0:a[0])||e.selectedImages[0].file_path:(null==(s=$[e.id])?void 0:s[0])||(null==(r=e.selectedImage)?void 0:r.file_path);return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"draft",scheduled_for:e.scheduledFor||eu(e.day),media_url:o,media_urls:d,enhanced_image_url:n?(null==(l=$[e.id])?void 0:l[0])||null:(null==(i=$[e.id])?void 0:i[0])||null,theme:e.theme,content_type:"weekly",business_context:"Day: ".concat(e.day,", Image Prompt: ").concat(e.imagePrompt)}});if(0===a.length)return void w("No posts to save. Please generate content first.");let{error:s}=await d.ND.from("posts").insert(a);if(s)throw s;I("Weekly content saved successfully!"),el.push("/dashboard")}catch(e){w(e.message)}finally{i(!1)}},em=async()=>{i(!0),w("");try{let{data:{user:t}}=await d.ND.auth.getUser();if(!t)throw Error("User not authenticated");let a=e.filter(e=>"generated"===e.status&&(e.selectedImage||e.selectedImages&&e.selectedImages.length>0)).map(e=>{var a,s,r,l,i;let n=e.selectedImages&&e.selectedImages.length>1,d=n?e.selectedImages.map((t,a)=>{var s;return(null==(s=$[e.id])?void 0:s[a])||t.file_path}):[],o=n?(null==(a=$[e.id])?void 0:a[0])||e.selectedImages[0].file_path:(null==(s=$[e.id])?void 0:s[0])||(null==(r=e.selectedImage)?void 0:r.file_path);return{user_id:t.id,caption:e.caption,hashtags:e.hashtags,platform:y,status:"scheduled",scheduled_for:e.scheduledFor||eu(e.day),media_url:o,media_urls:d,enhanced_image_url:n?(null==(l=$[e.id])?void 0:l[0])||null:(null==(i=$[e.id])?void 0:i[0])||null,theme:e.theme,content_type:"weekly",business_context:"Day: ".concat(e.day,", Image Prompt: ").concat(e.imagePrompt)}});if(0===a.length)return void w("No posts to schedule. Please generate content first.");let{error:s}=await d.ND.from("posts").insert(a);if(s)throw s;I("Weekly content scheduled successfully!"),setTimeout(()=>{el.push("/calendar")},2e3)}catch(e){w(e.message)}finally{i(!1)}},eu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"11:00",a=new Date,s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e),r=a.getDay(),l=new Date(a);l.setDate(a.getDate()+(s-r+7)%7+7);let[i,n]=t.split(":").map(Number);return l.setHours(i,n,0,0),l.toISOString()},eh=async()=>{C(!0),M("");try{let{data:{user:e}}=await d.ND.auth.getUser();if(!e)return;let{data:t,error:a}=await d.ND.from("media").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(a)throw a;S(t||[])}catch(e){M(e.message)}finally{C(!1)}},eg=(e,t,a,s)=>{T(e),L(t),J(a.join(" ")),B(s?new Date(s).toISOString().slice(0,16):null)},ex=e=>{let t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e.getDay()],a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],s=e.getDate(),r=e.getFullYear(),l=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return"".concat(t,", ").concat(a," ").concat(s,", ").concat(r," at ").concat(l,":").concat(i)},ep=e=>{t(t=>t.map((t,a)=>{var s;let r=null==(s=ev[a])?void 0:s.dateObj;if(r){let[a,s]=e.split(":").map(Number);return r.setHours(a,s,0,0),{...t,scheduledFor:r.toISOString()}}return{...t,scheduledFor:eu(t.day,e)}}))},eb=(e,a)=>{t(t=>t.map((t,s)=>{if(t.id===e){var r;let e=null==(r=ev[s])?void 0:r.dateObj;if(e){let[s,r]=a.split(":").map(Number);return e.setHours(s,r,0,0),{...t,scheduledFor:e.toISOString()}}return{...t,scheduledFor:eu(t.day,a)}}return t}))},ef=async(e,t,a,s)=>{Z(t=>({...t,[e]:{...t[e]||{},[s]:!0}})),w(""),Q(t=>{let a={...t};return a[e]&&(delete a[e][s],0===Object.keys(a[e]).length&&delete a[e]),a});try{let r;if(t.startsWith("blob:")){let e=await fetch(t),a=await e.blob();r=new File([a],"image.jpg",{type:a.type})}else if(t.startsWith("data:")){let e=await fetch(t),a=await e.blob();r=new File([a],"image.jpg",{type:a.type})}else{let e=await fetch(t),a=await e.blob();r=new File([a],"image.jpg",{type:a.type})}let{data:{session:l}}=await d.ND.auth.getSession();if(!(null==l?void 0:l.access_token))throw Error("User not authenticated");let i=new FormData;i.append("image",r),i.append("productDescription",a);let n=await fetch("/api/enhance-image",{method:"POST",headers:{Authorization:"Bearer ".concat(l.access_token)},body:i});if(!n.ok){let e=await n.json();if("safety_violation"===e.errorType)throw Error("This image cannot be enhanced due to content policy restrictions. Please try with a different image.");throw Error(e.error||"Failed to enhance image")}let o=await n.json();V(t=>({...t,[e]:{...t[e]||{},[s]:o.enhancedImageUrl}})),Y(t=>({...t,[e]:{...t[e]||{},[s]:!0}})),console.log("Image enhanced successfully:",o.enhancedImageUrl),void 0!==o.creditsRemaining&&(I("Image enhanced successfully! ".concat(o.creditsRemaining," enhancement credits remaining.")),setTimeout(()=>I(""),3e3))}catch(t){console.error("Error enhancing image:",t),Q(a=>({...a,[e]:{...a[e]||{},[s]:t.message||"Failed to enhance image"}}))}finally{Z(t=>({...t,[e]:{...t[e]||{},[s]:!1}}))}},ey=(e,t)=>{Y(a=>({...a,[e]:{...a[e]||{},[t]:!1}})),V(a=>{let s={...a};return s[e]&&(delete s[e][t],0===Object.keys(s[e]).length&&delete s[e]),s}),Q(a=>{let s={...a};return s[e]&&(delete s[e][t],0===Object.keys(s[e]).length&&delete s[e]),s})},ev=function(){let e=[],t=new Date,a=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];for(let r=1;r<=7;r++){let l=new Date(t);l.setDate(t.getDate()+r);let i=s[l.getDay()],n="".concat(l.getDate()," ").concat(a[l.getMonth()]," ").concat(l.getFullYear());e.push({day:i,date:n,dateObj:l})}return e}();return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsx)(n(),{href:"/dashboard",children:(0,s.jsxs)(o.$,{variant:"ghost",size:"sm",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})})}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-6 w-6 text-green-600 mr-2"}),(0,s.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Weekly Content Generator"})]})]})})}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-4 lg:px-8 py-6 sm:py-8",children:[j&&(0,s.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-red-800 text-xs sm:text-sm",children:j})}),N&&(0,s.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-green-800 text-xs sm:text-sm",children:N})}),!K&&(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6 mb-6 sm:mb-8",children:[(0,s.jsx)("h2",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-3 sm:mb-4",children:"Add Images for Each Day (Optional, up to 10 per day)"}),(0,s.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 md:grid-cols-7 gap-2 sm:gap-4",children:ev.map(e=>{let{day:t,date:a}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"font-medium text-gray-700 mb-1",children:t}),(0,s.jsx)("span",{className:"text-xs text-gray-500 mb-2",children:a}),D[t+a]&&D[t+a].length>0?(0,s.jsxs)("div",{className:"relative group image-selected flex flex-wrap gap-1 justify-center",children:[D[t+a].map((e,r)=>(0,s.jsxs)("div",{className:"relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,s.jsx)("video",{src:e.file_path,className:"w-12 h-12 object-cover rounded shadow mb-1",muted:!0,playsInline:!0}):(0,s.jsx)("img",{src:e.file_path,alt:t,className:"w-12 h-12 object-cover rounded shadow mb-1"}),(0,s.jsx)("button",{className:"absolute top-0 right-0 bg-white bg-opacity-80 rounded-full p-0.5 text-red-500 hover:text-red-700 text-xs",onClick:()=>F(e=>({...e,[t+a]:e[t+a].filter((e,t)=>t!==r)})),"aria-label":"Remove image",children:"\xd7"})]},e.id)),D[t+a].length<10&&(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>O(t+a),className:"w-12 h-12 flex items-center justify-center",children:[(0,s.jsx)(h.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Add Image"})]}),D[t+a].length>1&&(0,s.jsx)("span",{className:"absolute bottom-0 left-0 bg-blue-600 text-white text-xs px-1 rounded",children:"Carousel"})]}):(0,s.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>O(t+a),children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-1"}),"Select Image"]})]},t+a)})}),(0,s.jsx)("div",{className:"mt-6 sm:mt-8 flex gap-2 sm:gap-3 justify-center",children:(0,s.jsxs)(o.$,{onClick:eo,disabled:0===Object.values(D).flat().length,loading:b,variant:"primary",className:"btn-generate",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),b?"Generating Content...":"Generate Weekly Content"]})}),(0,s.jsx)("div",{className:"mt-3 text-sm text-gray-600 text-center",children:0===Object.values(D).flat().length?(0,s.jsx)("span",{className:"text-orange-600",children:"⚠️ Please select at least one image to enable generation"}):(0,s.jsxs)("span",{className:"text-green-600",children:["✅ ",Object.values(D).flat().length," image(s) selected"]})})]}),E&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg max-w-4xl w-full p-6 relative animate-fade-in",children:[(0,s.jsx)("button",{className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600",onClick:()=>{O(null),ea([])},"aria-label":"Close",children:"\xd7"}),(0,s.jsxs)("h3",{className:"text-lg font-bold mb-4",children:["Select Images for ",E.slice(0,E.indexOf(","))," ",E.slice(E.indexOf(",")+1)," (Up to 10)"]}),et.length>0&&(0,s.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-700",children:["Selected Images (",et.length,"/10)"]}),(0,s.jsx)("button",{onClick:()=>ea([]),className:"text-xs text-red-600 hover:text-red-800",children:"Clear All"})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:et.map((e,t)=>(0,s.jsxs)("div",{className:"relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,s.jsx)("video",{src:e.file_path,className:"w-12 h-12 object-cover rounded",muted:!0,playsInline:!0}):(0,s.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-12 h-12 object-cover rounded"}),(0,s.jsx)("button",{onClick:()=>ea(e=>e.filter((e,a)=>a!==t)),className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"\xd7"})]},e.id))})]}),_?(0,s.jsx)("div",{className:"text-gray-500",children:"Loading media..."}):A?(0,s.jsx)("div",{className:"text-red-500",children:A}):(0,s.jsxs)("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3 max-h-96 overflow-y-auto",children:[Array.isArray(k)&&k.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).map(e=>{let t=et.some(t=>t.id===e.id);return(0,s.jsxs)("button",{className:"focus:outline-none border-2 rounded overflow-hidden transition-all relative ".concat(t?"border-blue-500 bg-blue-50":"border-transparent hover:border-blue-300"),onClick:()=>{t?ea(t=>t.filter(t=>t.id!==e.id)):et.length<10&&ea(t=>[...t,e])},children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,s.jsx)(p,{src:e.file_path,fileName:e.file_name,className:"w-full h-20"}):(0,s.jsx)("img",{src:e.file_path,alt:e.file_name,className:"w-full h-20 object-cover"}),t&&(0,s.jsx)("div",{className:"absolute top-1 right-1 bg-blue-500 text-white rounded-full w-5 h-5 flex items-center justify-center text-xs",children:"✓"})]},e.id)}),(!Array.isArray(k)||Array.isArray(k)&&0===k.filter(e=>e&&e.mime_type&&(e.mime_type.startsWith("image/")||e.mime_type.startsWith("video/"))).length)&&(0,s.jsx)("div",{className:"col-span-full text-gray-500",children:"No media found in your media library."})]}),(0,s.jsxs)("div",{className:"mt-6 flex justify-end gap-3",children:[(0,s.jsx)("button",{onClick:()=>{O(null),ea([])},className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),(0,s.jsxs)("button",{onClick:()=>{F(e=>({...e,[E]:et})),O(null),ea([])},disabled:0===et.length,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:["Add ",et.length," Image",1!==et.length?"s":""]})]})]})}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Weekly Content Preview"}),e.some(e=>"generated"===e.status)&&(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Default Time:"}),(0,s.jsx)("input",{type:"time",value:es,onChange:e=>{er(e.target.value),ep(e.target.value)},className:"px-2 py-1 border border-gray-300 rounded text-sm"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)(o.$,{onClick:ec,loading:a,variant:"outline",children:[(0,s.jsx)(x.A,{className:"h-4 w-4 mr-2"}),"Save as Draft"]}),(0,s.jsxs)(o.$,{onClick:em,loading:a,className:"bg-green-600 hover:bg-green-700",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Schedule Posts"]})]})]})]}),b&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-blue-900",children:"Generating weekly content..."}),(0,s.jsx)("p",{className:"text-xs text-blue-700",children:"This may take a few moments. Please wait."})]})]})}),(0,s.jsx)("div",{className:"space-y-6",children:e.filter(e=>e.selectedImages&&e.selectedImages.length>0||e.selectedImage).map(t=>{var a,r,l,i,n,d;return(0,s.jsxs)("div",{className:"border border-gray-200 rounded-lg p-6 bg-white shadow-sm hover:shadow-md transition-shadow",children:[(0,s.jsx)("div",{className:"text-center mb-6",children:(0,s.jsx)("h4",{className:"font-semibold text-gray-900 text-lg",children:t.scheduledFor?ex(new Date(t.scheduledFor)):"Not scheduled"})}),(0,s.jsx)("div",{className:"mb-6",children:t.selectedImages&&t.selectedImages.length>0?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"flex gap-4",children:t.selectedImages.map((e,a)=>{var r,l,i,n,d,o;return(0,s.jsxs)("div",{className:"relative",children:[(null==(r=q[t.id])?void 0:r[a])&&(0,s.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:q[t.id][a]}),(0,s.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[e.mime_type&&e.mime_type.startsWith("video/")?(0,s.jsx)("video",{src:e.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,s.jsx)("img",{src:(null==(l=G[t.id])?void 0:l[a])&&(null==(i=$[t.id])?void 0:i[a])?$[t.id][a]:e.file_path,alt:"Preview ".concat(a+1),className:"w-full h-full object-cover"}),!(e.mime_type&&e.mime_type.startsWith("video/"))&&(0,s.jsx)("div",{className:"absolute top-2 left-2",children:(null==(n=G[t.id])?void 0:n[a])?(0,s.jsx)("button",{onClick:()=>ey(t.id,a),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,s.jsx)("button",{onClick:()=>ef(t.id,e.file_path,t.caption,a),disabled:null==(d=X[t.id])?void 0:d[a],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:(null==(o=X[t.id])?void 0:o[a])?"Enhancing...":"Enhance"})})]})]},e.id||a)})})}):t.selectedImage?(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsxs)("div",{className:"relative",children:[(null==(a=q[t.id])?void 0:a[0])&&(0,s.jsx)("div",{className:"mb-2 p-2 bg-red-50 border border-red-200 rounded text-red-800 text-xs",children:q[t.id][0]}),(0,s.jsxs)("div",{className:"w-64 h-80 bg-gray-100 border border-gray-200 rounded-lg overflow-hidden relative",children:[t.selectedImage.mime_type&&t.selectedImage.mime_type.startsWith("video/")?(0,s.jsx)("video",{src:t.selectedImage.file_path,className:"w-full h-full object-cover",controls:!0,muted:!0}):(0,s.jsx)("img",{src:(null==(r=G[t.id])?void 0:r[0])&&(null==(l=$[t.id])?void 0:l[0])?$[t.id][0]:t.selectedImage.file_path,alt:"Selected",className:"w-full h-full object-cover"}),!(t.selectedImage.mime_type&&t.selectedImage.mime_type.startsWith("video/"))&&(0,s.jsx)("div",{className:"absolute top-2 left-2",children:(null==(i=G[t.id])?void 0:i[0])?(0,s.jsx)("button",{onClick:()=>ey(t.id,0),className:"bg-gray-600 hover:bg-gray-700 text-white text-sm px-3 py-1.5 rounded shadow-lg",children:"Reset"}):(0,s.jsx)("button",{onClick:()=>ef(t.id,t.selectedImage.file_path,t.caption,0),disabled:null==(n=X[t.id])?void 0:n[0],className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white text-sm px-3 py-1.5 rounded shadow-lg disabled:opacity-50",children:(null==(d=X[t.id])?void 0:d[0])?"Enhancing...":"Enhance"})})]})]})}):(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("div",{className:"w-64 h-80 bg-gray-50 border border-gray-200 rounded-lg flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-gray-400 text-sm",children:"No images selected"})})})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 text-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caption"}),W!==t.id&&(0,s.jsx)("button",{onClick:()=>eg(t.id,t.caption,t.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),W===t.id?(0,s.jsx)("textarea",{value:R,onChange:e=>L(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs",rows:3}):(0,s.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:t.caption})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags"}),W!==t.id&&(0,s.jsx)("button",{onClick:()=>eg(t.id,t.caption,t.hashtags),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),W===t.id?(0,s.jsx)(c.p,{value:U,onChange:e=>J(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):(0,s.jsx)("p",{className:"text-sm text-gray-900 whitespace-pre-line",children:t.hashtags&&t.hashtags.length>0?t.hashtags.map(e=>"#".concat(e)).join(" "):""})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scheduled For"}),W!==t.id&&(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("button",{onClick:()=>eg(t.id,t.caption,t.hashtags,t.scheduledFor),className:"text-xs text-blue-600 hover:text-blue-800",children:"Edit"}),(0,s.jsx)("button",{onClick:()=>eb(t.id,es),className:"text-xs text-green-600 hover:text-green-800",children:"Quick Time"})]}),W===t.id?(0,s.jsx)("input",{type:"datetime-local",value:H||(t.scheduledFor?new Date(t.scheduledFor).toISOString().slice(0,16):(()=>{var a;let s=null==(a=ev[e.findIndex(e=>e.id===t.id)])?void 0:a.dateObj;if(s){let[e,t]=es.split(":").map(Number);return s.setHours(e,t,0,0),s.toISOString().slice(0,16)}return eu(t.day,es).slice(0,16)})()),onChange:e=>B(e.target.value),className:"w-full p-2 border border-gray-300 rounded mb-2 text-xs"}):(0,s.jsx)("p",{className:"text-sm text-gray-900",children:t.scheduledFor?ex(new Date(t.scheduledFor)):"Not scheduled"})]})]})]},t.id)})})]})]})]})}},9074:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},9946:(e,t,a)=>{"use strict";a.d(t,{A:()=>m});var s=a(2115);let r=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase()),i=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()},d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:a="currentColor",size:r=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:m,iconNode:u,...h}=e;return(0,s.createElement)("svg",{ref:t,...o,width:r,height:r,stroke:a,strokeWidth:i?24*Number(l)/Number(r):l,className:n("lucide",c),...!m&&!d(h)&&{"aria-hidden":"true"},...h},[...u.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(m)?m:[m]])}),m=(e,t)=>{let a=(0,s.forwardRef)((a,l)=>{let{className:d,...o}=a;return(0,s.createElement)(c,{ref:l,iconNode:t,className:n("lucide-".concat(r(i(e))),"lucide-".concat(e),d),...o})});return a.displayName=i(e),a}}},e=>{var t=t=>e(e.s=t);e.O(0,[3865,4277,6874,8441,1684,7358],()=>t(3667)),_N_E=e.O()}]);