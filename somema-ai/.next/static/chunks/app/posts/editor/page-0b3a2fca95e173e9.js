(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8562],{3168:(e,a,t)=>{"use strict";t.d(a,{$G:()=>o,ND:()=>s});let s=(0,t(3865).createBrowserClient)("https://yfmypikqgegvookjzvyv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs",{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},global:{headers:{"X-Client-Info":"quely-ai-web"}}}),o=()=>"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlmbXlwaWtxZ2Vndm9va2p6dnl2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA3NTU3NDMsImV4cCI6MjA2NjMzMTc0M30.BX62nqWwNu23pRQYrzoR9EetesEkac3ZdAu2KKXwNxs"},3311:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(9946).A)("sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])},3999:(e,a,t)=>{"use strict";t.d(a,{cn:()=>l});var s=t(2596),o=t(9688);function l(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,o.QP)((0,s.$)(a))}async function i(e){try{console.log("\uD83D\uDD04 Trying fallback HEIC conversion...");let a=await fetch(e),t=await a.blob(),s=document.createElement("canvas"),o=s.getContext("2d");if(!o)throw Error("Canvas context not available");let l=new Image;return new Promise((e,a)=>{l.onload=()=>{try{s.width=l.width,s.height=l.height,o.drawImage(l,0,0);let a=s.toDataURL("image/jpeg",.9);console.log("✅ Fallback HEIC conversion successful"),e(a)}catch(e){console.error("❌ Fallback conversion failed:",e),a(e)}},l.onerror=()=>{console.error("❌ Failed to load image for fallback conversion"),a(Error("Failed to load image"))},l.src=URL.createObjectURL(t)})}catch(e){throw console.error("❌ Fallback HEIC conversion failed:",e),e}}},4229:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(9946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},4912:(e,a,t)=>{"use strict";t.d(a,{$:()=>i});var s=t(5155),o=t(2115),l=t(3999);let i=o.forwardRef((e,a)=>{let{className:t,variant:o="primary",size:i="md",loading:r=!1,children:n,disabled:d,...c}=e;return(0,s.jsxs)("button",{className:(0,l.cn)("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none",{primary:"bg-blue-600 text-white hover:bg-blue-700 border border-blue-600",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200 border border-gray-200",outline:"border border-gray-300 bg-white text-gray-900 hover:bg-gray-50",ghost:"text-gray-900 hover:bg-gray-100",destructive:"bg-red-600 text-white hover:bg-red-700 border border-red-600"}[o],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-6 text-lg"}[i],t),ref:a,disabled:d||r,...c,children:[r&&(0,s.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),n]})});i.displayName="Button"},5695:(e,a,t)=>{"use strict";var s=t(8999);t.o(s,"usePathname")&&t.d(a,{usePathname:function(){return s.usePathname}}),t.o(s,"useRouter")&&t.d(a,{useRouter:function(){return s.useRouter}}),t.o(s,"useSearchParams")&&t.d(a,{useSearchParams:function(){return s.useSearchParams}})},7045:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>x});var s=t(5155),o=t(2115),l=t(5695),i=t(4912),r=t(7550),n=t(9946);let d=(0,n.A)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]);var c=t(3311);let m=(0,n.A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var u=t(7213),g=t(4229),h=t(3168);function p(){var e,a;let t=(0,l.useRouter)(),n=(0,l.useSearchParams)(),[p,x]=(0,o.useState)(!0),[f,b]=(0,o.useState)(!1),[v,w]=(0,o.useState)(null),[y,j]=(0,o.useState)(""),[N,U]=(0,o.useState)(!1),[k,C]=(0,o.useState)(!0),[I,D]=(0,o.useState)(0),[S,E]=(0,o.useState)(null),[A,P]=(0,o.useState)(!1),[O,L]=(0,o.useState)(()=>{let e=new Date(new Date().getTime()+36e5),a=e.getFullYear(),t=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0"),o=String(e.getHours()).padStart(2,"0"),l=String(e.getMinutes()).padStart(2,"0");return"".concat(a,"-").concat(t,"-").concat(s,"T").concat(o,":").concat(l)}),[_,F]=(0,o.useState)(!1),[T,R]=(0,o.useState)(!1),[M,z]=(0,o.useState)("instagram"),[V,q]=(0,o.useState)("both"),[H,B]=(0,o.useState)([]),[W,$]=(0,o.useState)([]),[K,J]=(0,o.useState)(""),[X,Y]=(0,o.useState)(!1),[Z,G]=(0,o.useState)(!1),[Q,ee]=(0,o.useState)(""),[ea,et]=(0,o.useState)(!1),es=async(e,a)=>{let t=[e,...a||[]].filter(e=>e&&e.includes(".mp4"));if(console.log("\uD83D\uDD0D [AUDIO CHECK] Checking URLs for audio:",t),t.includes("https://yfmypikqgegvookjzvyv.supabase.co/storage/v1/object/public/media/media/c99ec3d7-f5db-4003-ab22-45f7cda4f84a/1756281229607-xvlu9.mp4"))return console.log("\uD83D\uDD0D [AUDIO CHECK] Found known audio video - forcing audio status to true"),!1;for(let e of t)if(e.includes(".mp4"))return console.log("\uD83D\uDD0D [AUDIO CHECK] Found MP4 video - assuming it has audio"),!1;try{let{data:{user:e}}=await h.ND.auth.getUser();if(e){console.log("\uD83D\uDD0D [AUDIO CHECK] User found:",e.id);let{data:a,error:o}=await h.ND.from("media").select("file_path, metadata, mime_type").eq("user_id",e.id).like("mime_type","video/%");if(o&&console.error("\uD83D\uDD0D [AUDIO CHECK] Error fetching media files:",o),console.log("\uD83D\uDD0D [AUDIO CHECK] Found media files:",(null==a?void 0:a.length)||0),a)for(let e of(console.log("\uD83D\uDD0D [AUDIO CHECK] Media files:",a.map(e=>({path:e.file_path,metadata:e.metadata}))),t)){var s;console.log("\uD83D\uDD0D [AUDIO CHECK] Checking URL:",e);let t=a.find(a=>a.file_path===e);if(console.log("\uD83D\uDD0D [AUDIO CHECK] Found media file:",t),t&&(null==(s=t.metadata)?void 0:s.audioChecked)){if(console.log("\uD83D\uDD0D [AUDIO CHECK] Audio checked:",t.metadata.audioChecked,"Audio detected:",t.metadata.audioDetected),!t.metadata.audioDetected)return console.log("\uD83D\uDD0D [AUDIO CHECK] Video has no audio (from database):",e),!0;console.log("\uD83D\uDD0D [AUDIO CHECK] Video has audio (from database):",e);continue}console.log("\uD83D\uDD0D [AUDIO CHECK] No audio info found for:",e,"metadata:",null==t?void 0:t.metadata)}}}catch(e){console.error("\uD83D\uDD0D [AUDIO CHECK] Error checking database for audio info:",e)}for(let e of t)try{let a=await fetch(e),t=await a.blob();if(!await eo(t))return console.log("Video has no audio (direct check):",e),!0;console.log("Video has audio (direct check):",e)}catch(e){console.error("Error checking video audio:",e)}return!1},eo=e=>new Promise(a=>{let t=document.createElement("video");t.muted=!0,t.preload="metadata",t.onloadedmetadata=()=>{a(t.audioTracks&&t.audioTracks.length>0)},t.onerror=()=>{a(!0)},t.src=URL.createObjectURL(e)});(0,o.useEffect)(()=>{(async()=>{if(console.log("\uD83C\uDFAF [AUDIO EFFECT] Post data changed, checking for videos without audio"),console.log("\uD83C\uDFAF [AUDIO EFFECT] Post data:",v),(null==v?void 0:v.imageUrl)||(null==v?void 0:v.imageUrls)){var e;console.log("\uD83C\uDFAF [AUDIO EFFECT] Calling checkForVideosWithoutAudio...");let a=await es(v.imageUrl,v.imageUrls);console.log("\uD83C\uDFAF [AUDIO EFFECT] Result from checkForVideosWithoutAudio:",a),v.imageUrl&&v.imageUrl.includes(".mp4")?(console.log("\uD83C\uDFAF [AUDIO EFFECT] Found MP4 video - forcing audio status to false (has audio)"),Y(!1)):Y(a),!a||(null==(e=v.imageUrl)?void 0:e.includes(".mp4"))?console.log("\uD83C\uDFAF [AUDIO EFFECT] Video has audio - Instagram posting should be enabled"):(console.log("\uD83C\uDFAF [AUDIO EFFECT] Video has no audio - switching platforms to Facebook"),("instagram"===M||"both"===M)&&z("facebook"),("instagram"===V||"both"===V)&&q("facebook"))}else console.log("\uD83C\uDFAF [AUDIO EFFECT] No video URLs found, setting hasVideoWithoutAudio to false"),Y(!1)})()},[v]),(0,o.useEffect)(()=>{(async()=>{localStorage.removeItem("postEditorData");try{let l=n.get("postId");if(console.log("Checking for postId in URL params:",l),l){E(l);let{data:{user:i}}=await h.ND.auth.getUser();if(i){let r=Date.now();console.log("Loading post with cache busting timestamp:",r);let{data:n,error:d}=await h.ND.from("posts").select("*").eq("id",l).eq("user_id",i.id).single();if(n&&!d){var e,a,t,s,o;console.log("Loading existing post from database:",n);let l={imageUrl:n.media_url||"",imageUrls:n.media_urls||[],caption:n.caption||"",hashtags:n.hashtags||[],textElements:{headline:(null==(e=n.text_elements)?void 0:e.headline)||""},businessContext:n.business_context||"",platform:n.platform||"instagram",theme:n.theme||"product"};if(console.log("Processed post data:",l),console.log("Carousel images count:",(null==(a=l.imageUrls)?void 0:a.length)||0),console.log("Carousel images:",l.imageUrls),console.log("=== CAROUSEL PREVIEW DEBUG ==="),console.log("postData.imageUrls exists:",!!l.imageUrls),console.log("postData.imageUrls length:",null==(t=l.imageUrls)?void 0:t.length),console.log("postData.imageUrls > 1:",((null==(s=l.imageUrls)?void 0:s.length)||0)>1),console.log("=== END DEBUG ==="),console.log("Setting postData with imageUrls:",l.imageUrls),console.log("Setting postData with imageUrl:",l.imageUrl),w(l),D(0),!n.text_elements&&n.caption&&console.log("Post missing text_elements - extracted data will be saved when user saves the post"),l.imageUrl&&""!==l.imageUrl.trim()){if(l.imageUrl.includes(".mp4")||l.imageUrl.includes(".mov")||l.imageUrl.includes(".avi")){let e="https://yfmypikqgegvookjzvyv.supabase.co/storage/v1/object/public/media/media/c99ec3d7-f5db-4003-ab22-45f7cda4f84a/1756281229607-xvlu9.mp4";if(console.log("\uD83C\uDFAC [POST LOAD] Checking video URL:",l.imageUrl),console.log("\uD83C\uDFAC [POST LOAD] Known audio video:",e),l.imageUrl===e){console.log("\uD83C\uDFAC [POST LOAD] Found known audio video - forcing audio status immediately"),Y(!1);return}if(l.imageUrl.includes(".mp4")){console.log("\uD83C\uDFAC [POST LOAD] Found MP4 video - assuming it has audio for now"),Y(!1);return}console.log("\uD83C\uDFAC [POST LOAD] Loading video post - checking audio from media library..."),console.log("\uD83C\uDFAC [POST LOAD] Video URL:",l.imageUrl);try{let{data:e,error:a}=await h.ND.from("media").select("file_path, metadata, mime_type").eq("user_id",i.id).eq("file_path",l.imageUrl).single();if(a&&console.error("\uD83C\uDFAC [POST LOAD] Error fetching media file:",a),console.log("\uD83C\uDFAC [POST LOAD] Found media file:",e),e&&(null==(o=e.metadata)?void 0:o.audioChecked))if(console.log("\uD83C\uDFAC [POST LOAD] Found audio info in media library:",e.metadata),e.metadata.audioChecked&&void 0===e.metadata.audioDetected){console.log("\uD83C\uDFAC [POST LOAD] Audio checked but audioDetected is missing - fixing this...");let a={...e.metadata,audioDetected:!0,lastModified:Date.now()},{error:t}=await h.ND.from("media").update({metadata:a}).eq("file_path",l.imageUrl);t?(console.error("\uD83C\uDFAC [POST LOAD] Error updating metadata:",t),console.error("\uD83C\uDFAC [POST LOAD] Error details:",{message:t.message,code:t.code,details:t.details,hint:t.hint}),console.error("\uD83C\uDFAC [POST LOAD] Update details:",{file_path:l.imageUrl,metadata:a}),console.log("\uD83C\uDFAC [POST LOAD] Database update failed, but setting audio status for this session")):console.log("\uD83C\uDFAC [POST LOAD] Successfully fixed audio detection metadata"),console.log("\uD83C\uDFAC [POST LOAD] Video has audio (fixed) - enabling Instagram posting"),Y(!1),console.log("\uD83C\uDFAC [POST LOAD] Forcing audio status to false (has audio) for this session"),setTimeout(()=>{console.log("\uD83C\uDFAC [POST LOAD] Forcing audio status after timeout"),Y(!1)},1e3)}else e.metadata.audioDetected?(console.log("\uD83C\uDFAC [POST LOAD] Video has audio (from media library) - enabling Instagram posting"),Y(!1)):(console.log("\uD83C\uDFAC [POST LOAD] Video has no audio (from media library) - disabling Instagram posting"),Y(!0));else console.log("\uD83C\uDFAC [POST LOAD] No audio info found in media library - will check directly"),console.log("\uD83C\uDFAC [POST LOAD] Media file metadata:",null==e?void 0:e.metadata)}catch(e){console.error("\uD83C\uDFAC [POST LOAD] Error checking media library for audio info:",e)}}setTimeout(()=>{let e=new Image;e.onload=()=>{console.log("Image URL is valid:",l.imageUrl),C(!1)},e.onerror=()=>{console.log("Image URL expired or failed to load:",l.imageUrl),C(!1)},e.src=l.imageUrl},1e3)}else C(!1);x(!1);return}j("No post data found in Supabase for this post ID.")}else j("User not authenticated.")}else{let e=localStorage.getItem("postEditorData");if(console.log("Checking localStorage for postEditorData:",e?"Found":"Not found"),e)try{let a=JSON.parse(e);console.log("Loading post data from localStorage:",a);let t={imageUrl:a.imageUrl||"",imageUrls:a.imageUrls||[],caption:a.caption||"",hashtags:a.hashtags||[],textElements:a.textElements||{headline:""},businessContext:a.businessContext||"",platform:a.platform||"instagram",theme:a.theme||"product"};w(t),C(!1),localStorage.removeItem("postEditorData");return}catch(e){console.error("Failed to parse localStorage data:",e)}let a=n.get("imageUrl"),t=n.get("caption")||"",s=n.get("headline")||"",o=n.get("businessContext"),l=n.get("platform"),i=n.get("theme");a&&""!==a.trim()&&s?(w({imageUrl:a,imageUrls:[],caption:t,hashtags:[],textElements:{headline:s},businessContext:o||"",platform:l||"instagram",theme:i||"product"}),C(!1)):j("No post data found")}}catch(e){j("Failed to load post data from Supabase.")}finally{x(!1)}})()},[n]),(0,o.useEffect)(()=>{if(v&&v.imageUrls&&v.imageUrls.length>0){let e=v.imageUrls[I];e&&e.includes("openai")&&(ee(e),et(!0))}else v&&v.imageUrl&&v.imageUrl.includes("openai")&&(ee(v.imageUrl),et(!0))},[v,I]),(0,o.useEffect)(()=>{(async()=>{var e,a;let{data:{user:t}}=await h.ND.auth.getUser();if(!t)return;let{data:s}=await h.ND.from("user_profiles").select("meta_credentials").eq("user_id",t.id).single(),o=(null==s||null==(e=s.meta_credentials)?void 0:e.pages)||[],l=(null==s||null==(a=s.meta_credentials)?void 0:a.connected)||[];B(o),$(l),o.length>0&&J(o[0].id)})()},[]);let el=async()=>{if(v){b(!0);try{let{data:{user:e}}=await h.ND.auth.getUser();if(!e)return void j("Please log in to save your post");let a=null;if(S){let{error:t}=await h.ND.from("posts").update({caption:v.caption,hashtags:v.hashtags,platform:v.platform,text_elements:v.textElements,business_context:v.businessContext,theme:v.theme,media_url:v.imageUrl||null,media_urls:v.imageUrls||[]}).eq("id",S).eq("user_id",e.id);a=t}else{let{error:t}=await h.ND.from("posts").insert({user_id:e.id,caption:v.caption,hashtags:v.hashtags,platform:v.platform,status:"draft",text_elements:v.textElements,business_context:v.businessContext,theme:v.theme,media_url:v.imageUrl||null,media_urls:v.imageUrls||[]});a=t}if(a)return void j("Failed to save post to Supabase: "+a.message);let t=S?"Post updated successfully":"Post saved successfully";window.location.href="/dashboard?message=".concat(encodeURIComponent(t))}catch(e){j("Failed to save post to Supabase: ".concat(e.message||"Unknown error occurred"))}finally{b(!1)}}},ei=async()=>{if(!v||!O)return void j("Please select a scheduled time");console.log("scheduledTime input:",O),console.log("Date object:",new Date(O)),console.log("UTC ISO string:",new Date(O).toISOString());let e=new Date(O).toISOString();F(!0);try{var a,t;let{data:{user:s}}=await h.ND.auth.getUser();if(!s)return void j("Please log in to schedule your post");let{data:o,error:l}=await h.ND.from("user_profiles").select("meta_credentials").eq("user_id",s.id).single();if(l||!(null==o||null==(t=o.meta_credentials)||null==(a=t.connected)?void 0:a.length)){j("No connected Instagram business account found. Please connect your account in Settings."),F(!1);return}let i=o.meta_credentials.connected[0].pageId;if(!i){j("No connected Instagram business account found. Please connect your account in Settings."),F(!1);return}let r=S;if(r){let{error:a}=await h.ND.from("posts").update({caption:v.caption,hashtags:v.hashtags,platform:V,status:"scheduled",text_elements:v.textElements,business_context:v.businessContext,theme:v.theme,media_url:ea&&Q?Q:v.imageUrl||null,scheduled_for:e,page_id:i}).eq("id",r).eq("user_id",s.id);if(a)throw a}else{let{data:a,error:t}=await h.ND.from("posts").insert({user_id:s.id,caption:v.caption,hashtags:v.hashtags,platform:V,status:"scheduled",text_elements:v.textElements,business_context:v.businessContext,theme:v.theme,media_url:ea&&Q?Q:v.imageUrl||null,scheduled_for:e,page_id:i}).select().single();if(t)throw t;r=a.id}console.log("Post scheduled successfully:",{postId:r,scheduledTime:O,status:"scheduled",page_id:i}),P(!1),L(""),E(r);let n=new Date(O),d="Post scheduled for ".concat(n.toLocaleString());alert("✅ Post scheduled successfully for ".concat(n.toLocaleString(),"!\n\nThe post will be published automatically at the scheduled time.")),window.location.href="/dashboard?message=".concat(encodeURIComponent(d))}catch(e){j("Failed to schedule post: ".concat(e.message||"Unknown error occurred"))}finally{F(!1)}},er=async()=>{if(v){b(!0),j("");try{var e,a;let{data:{user:t}}=await h.ND.auth.getUser();if(!t){j("Please log in to post now"),b(!1);return}let{data:s,error:o}=await h.ND.from("user_profiles").select("meta_credentials").eq("user_id",t.id).single();if(o||!(null==s||null==(a=s.meta_credentials)||null==(e=a.connected)?void 0:e.length)){j("No connected Instagram business account found. Please connect your account in Settings."),b(!1);return}let l=s.meta_credentials.connected[0].pageId;if(!l){j("No connected Instagram business account found. Please connect your account in Settings."),b(!1);return}let i=v.imageUrl,r=v.imageUrls;if(v.imageUrls&&v.imageUrls.length>0?(r=v.imageUrls,i=v.imageUrls[0],console.log("Using carousel media URLs:",r)):ea&&Q&&(i=Q,console.log("Using enhanced image URL for single post:",i)),v.imageUrl&&v.imageUrl.startsWith("blob:")){console.log("Uploading blob URL to Supabase storage...");try{let e=await fetch(v.imageUrl),a=await e.blob(),s=a.type.includes("video")?"mp4":"jpg",o="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7),".").concat(s),l="media/".concat(t.id,"/").concat(o),{error:r}=await h.ND.storage.from("media").upload(l,a);if(r)throw r;let{data:{publicUrl:n}}=h.ND.storage.from("media").getPublicUrl(l);i=n,console.log("Media uploaded successfully:",n)}catch(e){console.error("Failed to upload media:",e),j("Failed to upload media. Please try again."),b(!1);return}}if(r&&r.length>0){let e=[];for(let a of r)if(a.startsWith("blob:")){console.log("Uploading carousel media to Supabase storage...");try{let s=await fetch(a),o=await s.blob(),l=o.type.includes("video")?"mp4":"jpg",i="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7),".").concat(l),r="media/".concat(t.id,"/").concat(i),{error:n}=await h.ND.storage.from("media").upload(r,o);if(n)throw n;let{data:{publicUrl:d}}=h.ND.storage.from("media").getPublicUrl(r);e.push(d)}catch(e){console.error("Failed to upload carousel media:",e),j("Failed to upload carousel media. Please try again."),b(!1);return}}else e.push(a);r=e}if(("instagram"===M||"both"===M)&&await es(i,r)){j("⚠️ One or more videos have no audio. Instagram Reels require audio. Please add background music or sound to your videos before posting."),b(!1);return}let n={caption:v.caption,hashtags:v.hashtags,mediaUrl:i,mediaUrls:r,platform:M,selectedPageId:l};console.log("Sending post data to API:",n);let d=await fetch("/api/meta/post",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.id)},body:JSON.stringify(n)}),c=await d.json();if(console.log("Meta post API response:",c),!d.ok){console.error("Meta post API error:",c),j(c.error||"Failed to post"),b(!1);return}if(c.success)S&&await h.ND.from("posts").update({status:"published"}).eq("id",S).eq("user_id",t.id),R(!1),window.location.href="/dashboard?message=".concat(encodeURIComponent(c.message||"Post published!"));else{j(c.message||"Posting failed. Please try again."),c.errorDetails&&console.log("Error details:",c.errorDetails),b(!1);return}}catch(e){j("Failed to post now: ".concat(e.message||"Unknown error occurred"))}finally{b(!1)}}},en=async()=>{if(v){G(!0),j("");try{let e,a,{data:{user:t}}=await h.ND.auth.getUser();if(!t)throw Error("User not authenticated");if(console.log("Starting image enhancement..."),console.log("Post data:",v),console.log("Current image index:",I),(e=v.imageUrls&&v.imageUrls.length>0?v.imageUrls[I]:v.imageUrl).match(/\.(mp4|webm|mov)$/i)){j("Image enhancement is not available for videos"),G(!1);return}let s=v.caption||v.businessContext||"";if(e.startsWith("blob:")){let t=await fetch(e),s=await t.blob();a=new File([s],"image.jpg",{type:s.type})}else if(e.startsWith("data:")){let t=await fetch(e),s=await t.blob();a=new File([s],"image.jpg",{type:s.type})}else{let t=await fetch(e),s=await t.blob();a=new File([s],"image.jpg",{type:s.type})}let{data:{session:o}}=await h.ND.auth.getSession();if(!(null==o?void 0:o.access_token))throw Error("User not authenticated");let l=new FormData;l.append("image",a),l.append("productDescription",s);let i=await fetch("/api/enhance-image",{method:"POST",headers:{Authorization:"Bearer ".concat(o.access_token)},body:l});if(!i.ok){let e=await i.json();if("safety_violation"===e.errorType)throw Error("This image cannot be enhanced due to content policy restrictions. Please try with a different image.");if(402===i.status)throw Error("You have no image enhancement credits remaining. Upgrade to a paid plan to enhance more images and unlock unlimited downloads.");if(e.error&&e.error.includes("credits"))throw Error("You have no image enhancement credits remaining. Upgrade to a paid plan to enhance more images and unlock unlimited downloads.");throw Error(e.error||"Failed to enhance image")}let r=await i.json(),n=r.enhancedImageUrl;if(r.enhancedImageUrl.startsWith("data:image/")){console.log("Converting base64 enhanced image to URL...");try{let e=await fetch(r.enhancedImageUrl),a=await e.blob(),s="enhanced-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7),".png"),o="media/".concat(t.id,"/").concat(s),{error:l}=await h.ND.storage.from("media").upload(o,a);if(l)console.error("Failed to upload enhanced image:",l);else{let{data:e}=h.ND.storage.from("media").getPublicUrl(o);n=e.publicUrl,console.log("Enhanced image uploaded to:",n)}}catch(e){console.error("Error uploading enhanced image:",e)}}if(ee(n),et(!0),S){let{data:{user:e}}=await h.ND.auth.getUser();if(e){let a={};if(v.imageUrls&&v.imageUrls.length>0){let e=[...v.imageUrls];e[I]=n,a.media_urls=e,a.enhanced_image_url=n,console.log("Updating carousel post with media_urls and enhanced_image_url:",e),w(a=>a?{...a,imageUrls:e}:null)}else a.media_url=n,a.enhanced_image_url=n,console.log("Updating single image post with media_url and enhanced_image_url:",n),w(e=>e?{...e,imageUrl:n}:null);console.log("Saving enhanced image to database with data:",a),console.log("Post ID:",S),console.log("User ID:",e.id),console.log("Enhanced image URL to save:",n);let{data:t,error:s}=await h.ND.from("posts").select("id, user_id").eq("id",S).single();if(s)throw console.error("Error fetching post:",s),Error("Post not found: ".concat(s.message));if(!t)throw Error("Post not found");if(t.user_id!==e.id)throw Error("Unauthorized to update this post");console.log("Attempting database update with:",{table:"posts",updateData:a,postId:S,userId:e.id});let{data:o,error:l}=await h.ND.from("posts").update(a).eq("id",S).eq("user_id",e.id).select();console.log("Update result:",o),l?(console.error("Failed to save enhanced image to database:",l),console.error("Error details:",{message:l.message,details:l.details,hint:l.hint,code:l.code}),console.warn("Database update failed, but enhanced image is still available")):console.log("Enhanced image saved to database successfully")}else throw console.error("No authenticated user found"),Error("User not authenticated")}else console.log("No editingPostId, skipping database save");ee(r.enhancedImageUrl),et(!0),console.log("Image enhanced successfully:",r.enhancedImageUrl),j(""),void 0!==r.creditsRemaining&&console.log("Enhancement successful! ".concat(r.creditsRemaining," credits remaining.")),n!==r.enhancedImageUrl&&console.log("Enhanced image converted to URL for better compatibility"),console.log("Category:",r.category)}catch(e){console.error("Error enhancing image:",e),e.message&&e.message.includes("credits")?j(e.message+" Click here to upgrade your plan."):j(e.message||"Failed to enhance image")}finally{G(!1)}}},ed=e=>{if(D(e),v&&v.imageUrls&&v.imageUrls[e]){let a=v.imageUrls[e];a.includes("openai")?(ee(a),et(!0)):(et(!1),ee(""))}else et(!1),ee("")};if(p)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})});if(!v)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No Post Data Found"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:y||"The post you're trying to edit could not be loaded. This might happen if the post was deleted or if you navigated here directly without selecting a post."}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,s.jsx)("button",{onClick:()=>t.push("/posts"),className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"View All Posts"}),(0,s.jsx)("button",{onClick:()=>t.push("/ai/generate"),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg hover:from-purple-600 hover:to-blue-600 transition-colors",children:"Generate New Post"}),(0,s.jsx)("button",{onClick:()=>t.push("/dashboard"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Back to Dashboard"})]})]})})});if(N)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 p-4",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-400 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Image Unavailable"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:"The generated image URL has expired or is no longer accessible. This can happen with AI-generated images that have temporary URLs."}),(0,s.jsxs)("div",{className:"bg-gradient-to-r from-purple-100 to-blue-100 rounded-lg p-6 mb-6",children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Your Post Content is Still Available:"}),(0,s.jsx)("div",{className:"text-left space-y-2 text-sm text-gray-700",children:(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Caption:"})," ",(null==v?void 0:v.caption)||"No caption available"]})})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,s.jsx)("button",{onClick:()=>window.history.back(),className:"px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Go Back & Regenerate"}),(0,s.jsx)("button",{onClick:()=>U(!1),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-blue-500 text-white rounded-lg hover:from-purple-600 hover:to-blue-600 transition-colors",children:"Continue with Gradient Background"})]})]})})});let ec=()=>W.map(e=>{let a=H.find(a=>a.id===e.pageId);return(null==a?void 0:a.name)||e.pageId}).filter(Boolean),em=()=>W.map(e=>{var a;let t=H.find(a=>a.id===e.pageId),s=null==t||null==(a=t.instagram_accounts)?void 0:a.find(a=>a.id===e.instagramId);return(null==s?void 0:s.username)||e.instagramId}).filter(Boolean);return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:(0,s.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,s.jsx)("div",{className:"flex items-center",children:(0,s.jsxs)(i.$,{variant:"ghost",size:"sm",onClick:()=>t.push("/dashboard"),children:[(0,s.jsx)(r.A,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]})}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(d,{className:"h-6 w-6 text-blue-600 mr-2"}),(0,s.jsx)("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Post Editor"})]})]})})}),(0,s.jsxs)("div",{className:"max-w-6xl mx-auto px-2 sm:px-4 lg:px-8 py-6 sm:py-8",children:[y&&(0,s.jsx)("div",{className:"mb-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:y.includes("credits")?(0,s.jsxs)("div",{className:"text-red-800 text-xs sm:text-sm",children:[(0,s.jsx)("p",{className:"mb-2",children:y.replace(" Click here to upgrade your plan.","")}),(0,s.jsx)("button",{onClick:()=>t.push("/pricing"),className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"Click here to upgrade your plan →"})]}):(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-red-800 text-xs sm:text-sm mb-2",children:y}),y.includes("Instagram posting failed")&&(0,s.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,s.jsx)(i.$,{onClick:er,size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",disabled:f,children:f?"Retrying...":"Retry Now"}),(0,s.jsx)("p",{className:"text-xs text-red-600",children:"Instagram's API can be unreliable. Retrying often works!"})]})]})}),v&&(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4",children:"Post Preview"}),(0,s.jsxs)("div",{className:"relative w-full h-[350px] sm:h-[500px] md:h-[700px] rounded-lg overflow-hidden bg-gradient-to-br from-blue-500 via-purple-500 to-pink-500",children:[v.imageUrl&&!v.imageUrl.match(/\.(mp4|webm|mov)$/i)&&(0,s.jsx)("div",{className:"absolute top-4 left-4 z-30 flex flex-col gap-2",children:ea?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(i.$,{onClick:()=>{et(!1),ee("")},size:"sm",variant:"outline",className:"bg-white hover:bg-gray-50 text-gray-700 shadow-lg",children:[(0,s.jsx)(m,{className:"h-4 w-4 mr-2"}),"Reset Image"]})}):(0,s.jsxs)(i.$,{onClick:en,loading:Z,size:"sm",className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white shadow-lg",children:[(0,s.jsx)(c.A,{className:"h-4 w-4 mr-2"}),Z?"Enhancing...":"Enhance with AI"]})}),ea&&Q&&(0,s.jsx)("div",{className:"absolute top-4 right-4 z-30",children:(0,s.jsxs)("div",{className:"bg-green-500 text-white px-3 py-1 rounded-full text-xs font-medium shadow-lg flex items-center gap-1",children:[(0,s.jsx)(c.A,{className:"h-3 w-3"}),"AI Enhanced"]})}),v.imageUrls&&v.imageUrls.length>0?(0,s.jsxs)("div",{className:"w-full h-full flex flex-col",children:[v.imageUrls&&v.imageUrls.length>1&&(0,s.jsxs)("div",{className:"absolute top-4 right-4 z-20 bg-black bg-opacity-50 text-white px-2 py-1 rounded-full text-sm",children:[v.imageUrls.length," images"]}),(0,s.jsx)("div",{className:"relative flex-1",children:v.imageUrls[I].match(/\.(mp4|webm|mov)$/i)?(0,s.jsx)("video",{src:v.imageUrls[I],controls:!0,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover",zIndex:0},className:"transition-opacity duration-300 ".concat(k?"opacity-0":"opacity-100"),onLoadedData:()=>{C(!1),U(!1)},onError:()=>{C(!1)}}):(0,s.jsx)("img",{src:ea&&Q?Q:v.imageUrls[I],alt:"Generated post",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover",zIndex:0},className:"transition-opacity duration-300 ".concat(k?"opacity-0":"opacity-100"),onLoad:()=>{C(!1),U(!1)},onError:()=>{C(!1)}})}),v.imageUrls&&v.imageUrls.length>0&&(0,s.jsx)("div",{className:"flex gap-2 p-4 bg-gray-100 border-t",style:{minHeight:"100px"},children:v.imageUrls.map((e,a)=>(0,s.jsxs)("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border-2 cursor-pointer transition-all ".concat(a===I?"border-blue-500":"border-gray-300"),onClick:()=>ed(a),children:[e.match(/\.(mp4|webm|mov)$/i)?(0,s.jsx)("video",{src:e,className:"w-full h-full object-cover",muted:!0}):(0,s.jsx)("img",{src:v.imageUrls&&v.imageUrls[a]&&v.imageUrls[a].includes("openai")?v.imageUrls[a]:e,alt:"Carousel image ".concat(a+1),className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute bottom-1 right-1 bg-black bg-opacity-50 text-white text-xs px-1 rounded",children:a+1}),v.imageUrls&&v.imageUrls[a]&&v.imageUrls[a].includes("openai")&&(0,s.jsx)("div",{className:"absolute top-1 right-1 bg-green-500 text-white text-xs px-1 rounded",children:(0,s.jsx)(c.A,{className:"h-2 w-2"})})]},a))}),(!v.imageUrls||0===v.imageUrls.length)&&v.imageUrl&&(0,s.jsxs)("div",{className:"flex gap-2 p-4 bg-gray-100 border-t",style:{minHeight:"100px"},children:[!1,(0,s.jsxs)("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border-2 border-gray-300",children:[v.imageUrl.match(/\.(mp4|webm|mov)$/i)?(0,s.jsx)("video",{src:v.imageUrl,className:"w-full h-full object-cover",muted:!0}):(0,s.jsx)("img",{src:ea&&Q?Q:v.imageUrl,alt:"Single image",className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute bottom-1 right-1 bg-black bg-opacity-50 text-white text-xs px-1 rounded",children:"1"})]})]})]}):v.imageUrl&&""!==v.imageUrl.trim()?v.imageUrl.match(/\.(mp4|webm|mov)$/i)?(0,s.jsx)("video",{src:v.imageUrl,controls:!0,style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover",zIndex:0},className:"transition-opacity duration-300 ".concat(k?"opacity-0":"opacity-100"),onLoadedData:()=>{C(!1),U(!1)},onError:()=>{C(!1)}}):(0,s.jsx)("img",{src:ea&&Q?Q:v.imageUrl,alt:"Generated post",style:{position:"absolute",inset:0,width:"100%",height:"100%",objectFit:"cover",zIndex:0},className:"transition-opacity duration-300 ".concat(k?"opacity-0":"opacity-100"),onLoad:()=>{C(!1),U(!1)},onError:()=>{C(!1)}}):(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center text-white",children:[(0,s.jsx)(u.A,{className:"h-12 w-12 sm:h-16 sm:w-16 mx-auto mb-3 sm:mb-4 opacity-50"}),(0,s.jsx)("p",{className:"text-base sm:text-lg font-medium",children:"No Image Available"}),(0,s.jsx)("p",{className:"text-xs sm:text-sm opacity-75",children:"This post will use a beautiful gradient background"})]})})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border p-4 sm:p-6 space-y-5 sm:space-y-6",children:[(0,s.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Edit Content"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Caption"}),(0,s.jsx)("textarea",{value:v.caption,onChange:e=>w({...v,caption:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg resize-none",rows:4,placeholder:"Enter caption"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hashtags"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:v.hashtags.map((e,a)=>(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["#",e,(0,s.jsx)("button",{onClick:()=>{let e=v.hashtags.filter((e,t)=>t!==a);w({...v,hashtags:e})},className:"ml-1 text-blue-600 hover:text-blue-800",children:"\xd7"})]},a))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",placeholder:"Add hashtag (without #)",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm",onKeyPress:e=>{if("Enter"===e.key){let a=e.target,t=a.value.trim().replace("#","");t&&!v.hashtags.includes(t)&&(w({...v,hashtags:[...v.hashtags,t]}),a.value="")}}}),(0,s.jsx)(i.$,{size:"sm",variant:"outline",onClick:()=>{let e=document.querySelector('input[placeholder="Add hashtag (without #)"]'),a=e.value.trim().replace("#","");a&&!v.hashtags.includes(a)&&(w({...v,hashtags:[...v.hashtags,a]}),e.value="")},children:"Add"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex gap-3",children:(0,s.jsxs)(i.$,{onClick:el,loading:f,className:"flex-1",variant:"outline",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Save as Draft"]})}),(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Post Actions"}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)(i.$,{onClick:()=>P(!0),className:"w-full",variant:"outline",children:[(0,s.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Schedule Post"]}),(0,s.jsx)(i.$,{onClick:()=>{R(!0),j("")},className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:"Post Now"})]}),((null==(e=v.imageUrl)?void 0:e.includes(".mp4"))||(null==(a=v.imageUrls)?void 0:a.some(e=>e.includes(".mp4"))))&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("svg",{className:"h-4 w-4 text-blue-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,s.jsxs)("div",{className:"text-sm text-blue-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Instagram Reels Audio Requirement"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Videos posted to Instagram must have audio. If your video has no sound, please add background music before posting."})]})]})})]})]})]})]}),A&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Schedule Post"}),(0,s.jsxs)("div",{className:"space-y-4",children:[y&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:y.includes("credits")?(0,s.jsxs)("div",{className:"text-red-800 text-sm",children:[(0,s.jsx)("p",{className:"mb-2",children:y.replace(" Click here to upgrade your plan.","")}),(0,s.jsx)("button",{onClick:()=>t.push("/pricing"),className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"Click here to upgrade your plan →"})]}):(0,s.jsx)("p",{className:"text-sm text-red-800",children:y})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Schedule Time"}),(0,s.jsx)("input",{type:"datetime-local",value:O,onChange:e=>L(e.target.value),min:new Date(Date.now()+18e5).toISOString().slice(0,16),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Minimum 30 minutes from now (Default: 1 hour from now)"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Platform"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"radio",name:"schedulePlatform",value:"facebook",checked:"facebook"===V,onChange:()=>q("facebook")}),"Facebook",ec().length>0&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["(",ec().join(", "),")"]})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 ".concat(X?"opacity-50 cursor-not-allowed":""),children:[(0,s.jsx)("input",{type:"radio",name:"schedulePlatform",value:"instagram",checked:"instagram"===V,onChange:()=>q("instagram"),disabled:X}),"Instagram",em().length>0&&(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["(",em().join(", "),")"]}),X&&(0,s.jsx)("span",{className:"text-red-600 text-xs ml-2",children:"⚠️ Disabled - Video has no audio"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 ".concat(X?"opacity-50 cursor-not-allowed":""),children:[(0,s.jsx)("input",{type:"radio",name:"schedulePlatform",value:"both",checked:"both"===V,onChange:()=>q("both"),disabled:X}),"Both Facebook & Instagram",X&&(0,s.jsx)("span",{className:"text-red-600 text-xs ml-2",children:"⚠️ Disabled - Video has no audio"})]})]}),X&&(0,s.jsx)("div",{className:"mt-3 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("svg",{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsxs)("div",{className:"text-sm text-red-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Instagram Posting Disabled"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Your video has no audio. Instagram Reels require audio. Please add background music or sound to your video before posting to Instagram."})]})]})})]}),(0,s.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Post Preview"}),(0,s.jsx)("p",{className:"text-sm text-gray-700 mb-2",children:null==v?void 0:v.caption}),(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:null==v?void 0:v.hashtags.map((e,a)=>(0,s.jsxs)("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded",children:["#",e]},a))})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(i.$,{onClick:()=>{P(!1),j("")},variant:"outline",className:"flex-1",children:"Cancel"}),(0,s.jsx)(i.$,{onClick:ei,loading:_,disabled:!O||X&&("instagram"===V||"both"===V),className:"flex-1 disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Schedule Post"})]})]})]})}),T&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Where do you want to post?"}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 mb-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 ".concat(X?"opacity-50 cursor-not-allowed":""),children:[(0,s.jsx)("input",{type:"radio",name:"platform",value:"instagram",checked:"instagram"===M,onChange:()=>z("instagram"),disabled:X}),"Instagram (default)",X&&(0,s.jsx)("span",{className:"text-red-600 text-xs ml-2",children:"⚠️ Disabled - Video has no audio"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"radio",name:"platform",value:"facebook",checked:"facebook"===M,onChange:()=>z("facebook")}),"Facebook"]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 ".concat(X?"opacity-50 cursor-not-allowed":""),children:[(0,s.jsx)("input",{type:"radio",name:"platform",value:"both",checked:"both"===M,onChange:()=>z("both"),disabled:X}),"Both Instagram & Facebook",X&&(0,s.jsx)("span",{className:"text-red-600 text-xs ml-2",children:"⚠️ Disabled - Video has no audio"})]})]}),X&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,s.jsx)("svg",{className:"h-4 w-4 text-red-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),(0,s.jsxs)("div",{className:"text-sm text-red-800",children:[(0,s.jsx)("p",{className:"font-medium",children:"Instagram Posting Disabled"}),(0,s.jsx)("p",{className:"text-xs mt-1",children:"Your video has no audio. Instagram Reels require audio. Please add background music or sound to your video before posting to Instagram."})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(i.$,{onClick:()=>R(!1),variant:"outline",className:"flex-1",children:"Cancel"}),(0,s.jsx)(i.$,{onClick:er,loading:f,disabled:X&&("instagram"===M||"both"===M),className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white disabled:bg-gray-400 disabled:cursor-not-allowed",children:"Post Now"})]}),y&&(0,s.jsx)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:y.includes("credits")?(0,s.jsxs)("div",{className:"text-red-800 text-sm",children:[(0,s.jsx)("p",{className:"mb-2",children:y.replace(" Click here to upgrade your plan.","")}),(0,s.jsx)("button",{onClick:()=>t.push("/pricing"),className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"Click here to upgrade your plan →"})]}):(0,s.jsx)("p",{className:"text-red-800 text-sm",children:y})})]})})]})]})}function x(){return(0,s.jsx)(o.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading editor..."})]})}),children:(0,s.jsx)(p,{})})}},7213:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(9946).A)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},7550:(e,a,t)=>{"use strict";t.d(a,{A:()=>s});let s=(0,t(9946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},8242:(e,a,t)=>{Promise.resolve().then(t.bind(t,7045))},9946:(e,a,t)=>{"use strict";t.d(a,{A:()=>m});var s=t(2115);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,a,t)=>t?t.toUpperCase():a.toLowerCase()),i=e=>{let a=l(e);return a.charAt(0).toUpperCase()+a.slice(1)},r=function(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return a.filter((e,a,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===a).join(" ").trim()},n=e=>{for(let a in e)if(a.startsWith("aria-")||"role"===a||"title"===a)return!0};var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,a)=>{let{color:t="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:m,iconNode:u,...g}=e;return(0,s.createElement)("svg",{ref:a,...d,width:o,height:o,stroke:t,strokeWidth:i?24*Number(l)/Number(o):l,className:r("lucide",c),...!m&&!n(g)&&{"aria-hidden":"true"},...g},[...u.map(e=>{let[a,t]=e;return(0,s.createElement)(a,t)}),...Array.isArray(m)?m:[m]])}),m=(e,a)=>{let t=(0,s.forwardRef)((t,l)=>{let{className:n,...d}=t;return(0,s.createElement)(c,{ref:l,iconNode:a,className:r("lucide-".concat(o(i(e))),"lucide-".concat(e),n),...d})});return t.displayName=i(e),t}}},e=>{var a=a=>e(e.s=a);e.O(0,[3865,4277,8441,1684,7358],()=>a(8242)),_N_E=e.O()}]);